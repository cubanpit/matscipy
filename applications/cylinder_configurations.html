<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Building cylindrical configurations with dislocations &mdash; matscipy devel documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fracture Mechanics" href="fracture_mechanics.html" />
    <link rel="prev" title="Plasticity" href="plasticity.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            matscipy
          </a>
              <div class="version">
                devel
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Matscipy</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Application domains</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="elastic_constants.html">Elastic Constants</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="plasticity.html">Plasticity</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="plasticity.html#installation-and-tests">Installation and tests</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="plasticity.html#tutorials">Tutorials:</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Building cylindrical configurations with dislocations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="fracture_mechanics.html">Fracture Mechanics</a></li>
<li class="toctree-l2"><a class="reference internal" href="tribology.html">Tribology</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">Analysis tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../calculators/index.html">Interatomic potentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">matscipy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Application domains</a></li>
          <li class="breadcrumb-item"><a href="plasticity.html">Plasticity</a></li>
      <li class="breadcrumb-item active">Building cylindrical configurations with dislocations</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/applications/cylinder_configurations.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="building-cylindrical-configurations-with-dislocations">
<h1>Building cylindrical configurations with dislocations<a class="headerlink" href="#building-cylindrical-configurations-with-dislocations" title="Permalink to this heading"></a></h1>
<p><img alt="" src="../_images/dislocation_cylinder.png" /></p>
<p>The <code class="docutils literal notranslate"><span class="pre">matscipy.dislocation</span></code> provides a set of tools to create atomistic configurations containing dislocations. In this example we focus on cylindrical configurations. In order to create a dislocation we start with a cylinder of bulk material oriented along the vector of the future dislocation line <span class="math notranslate nohighlight">\(\vec l\)</span>. By convention assumed in <code class="docutils literal notranslate"><span class="pre">matscipy.dislocation</span></code> Z direction of the cell always corresponds to the dislocation line <span class="math notranslate nohighlight">\(\vec l\)</span>. Then a displacement field is applied to the cylinder and outer radial shell is fixed in order to stabilise the configuration. So we end up with periodic boundary conditions along the dislocation line (Z) and fixed boundaries along X and Y directions. As shown on the figure above, screw dislocations are characterised by a displacement with corresponding burgers vector <span class="math notranslate nohighlight">\(\vec b\)</span> parallel to the dislocation line <span class="math notranslate nohighlight">\(\vec l\)</span>, while edge dislocations have the burgers vector <span class="math notranslate nohighlight">\(\vec b\)</span> perpendicular to <span class="math notranslate nohighlight">\(\vec l\)</span>. <code class="docutils literal notranslate"><span class="pre">matscipy</span></code> uses an anisotropic solution within <a class="reference external" href="https://doi.org/10.1080/14786435808565804">Stroh formalism</a> to generate displacement field as implemented in <a class="reference external" href="https://www.ctcms.nist.gov/potentials/atomman/">atomman</a> package.</p>
<p>For the interactive visualisation of the structures we will use <a class="reference external" href="https://nglviewer.org/nglview/latest/">nglview</a> which allows viewing atomistic structures interactively within an IPython/Jupyter notebooks. We will also color atoms according to the crystallographic structure identified by <a class="reference external" href="https://www.ovito.org/docs/current/reference/pipelines/modifiers/common_neighbor_analysis.html">Common Neighbour Analysis algoritm</a> and its <a class="reference external" href="https://www.ovito.org/docs/current/reference/pipelines/modifiers/identify_diamond.html">extention for diamond structure</a> implemented in <a class="reference external" href="https://www.ovito.org/docs/current/introduction.html">OVITO</a> package. <a class="reference external" href="https://www.ovito.org/docs/current/introduction.html">OVITO</a>, <a class="reference external" href="https://www.ctcms.nist.gov/potentials/atomman/">atomman</a> and <a class="reference external" href="https://nglviewer.org/nglview/latest/">nglview</a> are not part of the default dependencies of <code class="docutils literal notranslate"><span class="pre">matscipy</span></code> and require separate installation. Keep that in mind while running these examples as well test in <a class="reference external" href="https://github.com/libAtoms/matscipy/blob/master/tests/test_dislocation.py"><code class="docutils literal notranslate"><span class="pre">test_dislocation.py</span></code></a> since the majority of the tests there require this modules and thus will be skipped if the modules are not found in your system. Please note that for this example we use very small systems (small radius). For production calculations one should do a convergence tests with the system size in order to ensure that fixed boundaries do not affect the studied properties.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nglview</span> <span class="c1"># this import is necessary for rendering of the 3D view</span>
<span class="kn">from</span> <span class="nn">visualisation</span> <span class="kn">import</span> <span class="n">show_dislocation</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "7462980e8bf24a3fbcde7270bc02943a"}</script><div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ImportError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">nglview</span> <span class="c1"># this import is necessary for rendering of the 3D view</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="kn">from</span> <span class="nn">visualisation</span> <span class="kn">import</span> <span class="n">show_dislocation</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">work</span><span class="o">/</span><span class="n">matscipy</span><span class="o">/</span><span class="n">matscipy</span><span class="o">/</span><span class="n">docs</span><span class="o">/</span><span class="n">applications</span><span class="o">/</span><span class="n">visualisation</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="kn">from</span> <span class="nn">ovito.io.ase</span> <span class="kn">import</span> <span class="n">ase_to_ovito</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">from</span> <span class="nn">ovito.modifiers</span> <span class="kn">import</span> <span class="n">CommonNeighborAnalysisModifier</span><span class="p">,</span> <span class="n">IdentifyDiamondModifier</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">from</span> <span class="nn">ovito.pipeline</span> <span class="kn">import</span> <span class="n">StaticSource</span><span class="p">,</span> <span class="n">Pipeline</span>

<span class="n">File</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">ovito</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">21</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span> <span class="kn">import</span> <span class="nn">ovito.nonpublic</span>
<span class="g g-Whitespace">     </span><span class="mi">20</span> <span class="c1"># Load all extension modules.</span>
<span class="ne">---&gt; </span><span class="mi">21</span> <span class="kn">import</span> <span class="nn">ovito._extensions</span>
<span class="g g-Whitespace">     </span><span class="mi">23</span> <span class="c1"># The public symbols of this root module:</span>
<span class="g g-Whitespace">     </span><span class="mi">24</span> <span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">,</span> <span class="s1">&#39;version_string&#39;</span><span class="p">,</span> <span class="s1">&#39;scene&#39;</span><span class="p">,</span> <span class="s1">&#39;Scene&#39;</span><span class="p">,</span> <span class="s1">&#39;enable_logging&#39;</span><span class="p">]</span>

<span class="n">File</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">ovito</span><span class="o">/</span><span class="n">_extensions</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">6</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="c1"># Load all plugin extension modules under the _extensions package.</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="k">for</span> <span class="n">modinfo</span> <span class="ow">in</span> <span class="n">pkgutil</span><span class="o">.</span><span class="n">walk_packages</span><span class="p">(</span><span class="n">__path__</span><span class="p">,</span> <span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span><span class="p">):</span>
<span class="ne">----&gt; </span><span class="mi">6</span>     <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">modinfo</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="nn">File /usr/lib/python3.10/importlib/__init__.py:126,</span> in <span class="ni">import_module</span><span class="nt">(name, package)</span>
<span class="g g-Whitespace">    </span><span class="mi">124</span>             <span class="k">break</span>
<span class="g g-Whitespace">    </span><span class="mi">125</span>         <span class="n">level</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="ne">--&gt; </span><span class="mi">126</span> <span class="k">return</span> <span class="n">_bootstrap</span><span class="o">.</span><span class="n">_gcd_import</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="n">level</span><span class="p">:],</span> <span class="n">package</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>

<span class="n">File</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">ovito</span><span class="o">/</span><span class="n">_extensions</span><span class="o">/</span><span class="n">averaging</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Load dependencies.</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">ovito._extensions.pyscript</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">ovito._extensions.stdobj</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="c1"># Load the C extension module.</span>

<span class="n">File</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">ovito</span><span class="o">/</span><span class="n">_extensions</span><span class="o">/</span><span class="n">pyscript</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Load the C extension module.</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">ovito.plugins.PyScript</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="c1"># Load class add-ons.</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">import</span> <span class="nn">ovito._scene_class</span>

<span class="n">File</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">ovito</span><span class="o">/</span><span class="n">plugins</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">36</span>
<span class="g g-Whitespace">     </span><span class="mi">26</span>     <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Incompatible version of the Qt cross-platform framework detected!</span><span class="se">\n</span><span class="s2">This version of the OVITO Python module is based on Qt6 (loaded via the PySide6 bindings module), &quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">27</span>         <span class="s2">&quot;but bindings for old Qt5 are already loaded at this point (through PyQt5 or PySide2 imports preceding the import of OVITO). To avoid library version conflicts, please make sure the rest of &quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">28</span>         <span class="s2">&quot;your application uses Qt6 too instead of Qt5. &quot;</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">31</span>         <span class="s2">&quot;In addition, it may help to set the environment variable QT_API=pyside6 to force third-party packages (e.g. matplotlib) to load Qt6 instead of Qt5. &quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">32</span>         <span class="s2">&quot;If you have any questions, please contact support@ovito.org.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">34</span> <span class="c1"># Load all the Qt bindings first before OVITO&#39;s own C++ modules get loaded.</span>
<span class="g g-Whitespace">     </span><span class="mi">35</span> <span class="c1"># This ensures that the right Qt shared libraries needed by OVITO are already loaded into the process when running in a system Python interpreter.</span>
<span class="ne">---&gt; </span><span class="mi">36</span> <span class="kn">from</span> <span class="nn">ovito.qt_compat</span> <span class="kn">import</span> <span class="n">QtCore</span>
<span class="g g-Whitespace">     </span><span class="mi">37</span> <span class="kn">from</span> <span class="nn">ovito.qt_compat</span> <span class="kn">import</span> <span class="n">QtGui</span>
<span class="g g-Whitespace">     </span><span class="mi">38</span> <span class="kn">from</span> <span class="nn">ovito.qt_compat</span> <span class="kn">import</span> <span class="n">QtWidgets</span>

<span class="n">File</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">ovito</span><span class="o">/</span><span class="n">qt_compat</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">11</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="c1"># Import Shiboken module first to preload shiboken6.dll, which is needed by the Qt DLLs.</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="kn">import</span> <span class="nn">shiboken6</span> <span class="k">as</span> <span class="nn">shiboken</span> 
<span class="ne">---&gt; </span><span class="mi">11</span> <span class="kn">from</span> <span class="nn">PySide6</span> <span class="kn">import</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="p">,</span> <span class="n">QtNetwork</span><span class="p">,</span> <span class="n">QtXml</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> <span class="c1"># The QtOpenGLWidgets module is not included in the embedded PySide6 installation of OVITO Pro 3.7,</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span> <span class="c1"># but it should be loaded when using the PyPI version of PySide6.</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span> <span class="k">try</span><span class="p">:</span>

<span class="ne">ImportError</span>: libEGL.so.1: cannot open shared object file: No such file or directory
</pre></div>
</div>
</div>
</div>
<section id="body-centered-cubic">
<h2>Body Centered Cubic<a class="headerlink" href="#body-centered-cubic" title="Permalink to this heading"></a></h2>
<p>For the case of BCC structure we take tungsten as an example. In order to create a dislocation configuration one has to provide lattice parameter and elastic constants. It is possible to provide these values from literature. However, if you plan to relax the configuration with an interatomic potential, <code class="docutils literal notranslate"><span class="pre">matscipy.dislocation</span></code> provides a convenient method <code class="docutils literal notranslate"><span class="pre">get_elastic_constants</span></code> to calculate desired properties. We will use and Embedded Atom Potential from <a class="reference external" href="http://dx.doi.org/10.1088/0953-8984/25/39/395502">Marinica <em>et. al.</em> 2013 paper</a> (version EAM4) for the case of tungsten.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matscipy.dislocation</span> <span class="kn">import</span> <span class="n">get_elastic_constants</span>
<span class="c1"># the calculator to provide forces and energies from the potential</span>
<span class="kn">from</span> <span class="nn">matscipy.calculators.eam</span> <span class="kn">import</span> <span class="n">EAM</span>
<span class="n">eam_calc</span> <span class="o">=</span> <span class="n">EAM</span><span class="p">(</span><span class="s2">&quot;../../tests/w_eam4.fs&quot;</span><span class="p">)</span>

<span class="c1"># the function accepts any ASE type of calculator</span>
<span class="n">alat</span><span class="p">,</span> <span class="n">C11</span><span class="p">,</span> <span class="n">C12</span><span class="p">,</span> <span class="n">C44</span> <span class="o">=</span> <span class="n">get_elastic_constants</span><span class="p">(</span><span class="n">calculator</span><span class="o">=</span><span class="n">eam_calc</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;W&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      Step     Time          Energy         fmax
*Force-consistent energies used in optimization.
FIRE:    0 15:29:59      -17.792788*       1.5616
FIRE:    1 15:29:59      -17.796007*       1.2330
FIRE:    2 15:29:59      -17.798904*       0.6354
FIRE:    3 15:29:59      -17.799853*       0.2223
FIRE:    4 15:29:59      -17.799882*       0.1976
FIRE:    5 15:29:59      -17.799928*       0.1509
FIRE:    6 15:29:59      -17.799970*       0.0870
FIRE:    7 15:29:59      -17.799991*       0.0130
FIRE:    8 15:29:59      -17.799981*       0.0629
FIRE:    9 15:29:59      -17.799981*       0.0611
FIRE:   10 15:29:59      -17.799982*       0.0576
FIRE:   11 15:29:59      -17.799984*       0.0525
FIRE:   12 15:29:59      -17.799986*       0.0458
FIRE:   13 15:29:59      -17.799988*       0.0379
FIRE:   14 15:29:59      -17.799989*       0.0289
FIRE:   15 15:29:59      -17.799991*       0.0191
FIRE:   16 15:29:59      -17.799991*       0.0076
FIRE:   17 15:29:59      -17.799992*       0.0052
FIRE:   18 15:29:59      -17.799992*       0.0052
FIRE:   19 15:29:59      -17.799992*       0.0051
FIRE:   20 15:29:59      -17.799992*       0.0049
FIRE:   21 15:29:59      -17.799992*       0.0047
FIRE:   22 15:29:59      -17.799992*       0.0044
FIRE:   23 15:29:59      -17.799992*       0.0041
FIRE:   24 15:29:59      -17.799992*       0.0038
FIRE:   25 15:29:59      -17.799992*       0.0034
FIRE:   26 15:29:59      -17.799992*       0.0028
FIRE:   27 15:29:59      -17.799992*       0.0022
FIRE:   28 15:29:59      -17.799992*       0.0015
FIRE:   29 15:29:59      -17.799992*       0.0006
FIRE:   30 15:30:00      -17.799992*       0.0003
FIRE:   31 15:30:00      -17.799992*       0.0003
FIRE:   32 15:30:00      -17.799992*       0.0003
FIRE:   33 15:30:00      -17.799992*       0.0003
FIRE:   34 15:30:00      -17.799992*       0.0003
FIRE:   35 15:30:00      -17.799992*       0.0003
FIRE:   36 15:30:00      -17.799992*       0.0003
FIRE:   37 15:30:00      -17.799992*       0.0003
FIRE:   38 15:30:00      -17.799992*       0.0002
FIRE:   39 15:30:00      -17.799992*       0.0002
FIRE:   40 15:30:00      -17.799992*       0.0002
FIRE:   41 15:30:00      -17.799992*       0.0001
FIRE:   42 15:30:00      -17.799992*       0.0001
Fitting C_11
Strain array([-0.02, -0.01,  0.  ,  0.01,  0.02])
Stress array([-1.18143011e+01, -5.57729763e+00, -2.88261126e-04,  4.98286691e+00,
        9.85079614e+00]) GPa
Cij (gradient) / GPa    :     538.9035896451805
Error in Cij / GPa      :     16.584381718776033
Correlation coefficient :     0.9985824334709763
Setting C11 (1) to 3.363572 +/- 0.103512


Fitting C_21
Strain array([-0.02, -0.01,  0.  ,  0.01,  0.02])
Stress array([-5.18171556e+00, -2.29563243e+00, -2.88261126e-04,  1.85153957e+00,
        3.74132626e+00]) GPa
Cij (gradient) / GPa    :     219.93255649330877
Error in Cij / GPa      :     12.450223131451542
Correlation coefficient :     0.9952274688373499
Setting C21 (7) to 1.372711 +/- 0.077708


Fitting C_31
Strain array([-0.02, -0.01,  0.  ,  0.01,  0.02])
Stress array([-5.18171556e+00, -2.29563243e+00, -2.88261126e-04,  1.85153957e+00,
        3.74132626e+00]) GPa
Cij (gradient) / GPa    :     219.93255649330868
Error in Cij / GPa      :     12.450223131451247
Correlation coefficient :     0.9952274688373501
Updating C31 (7) with value 1.372711 +/- 0.077708


Fitting C_44
Strain array([-0.02, -0.01,  0.  ,  0.01,  0.02])
Stress array([-4.37426370e+00, -1.88654647e+00,  9.30635418e-15,  1.43563268e+00,
        2.90478138e+00]) GPa
Cij (gradient) / GPa    :     178.80269302570218
Error in Cij / GPa      :     12.702352202927047
Correlation coefficient :     0.9925146216927534
Setting C44 (4) to 1.115999 +/- 0.079282


[[b C11 b C12 b C12 b     b     b    ]
 [b C12 b C11 b C12 b     b     b    ]
 [b C12 b C12 b C11 b     b     b    ]
 [b     b     b     b C44 b     b    ]
 [b     b     b     b     b C44 b    ]
 [b     b     b     b     b     b C44]]

 = 

[[538.9  219.93 219.93   0.     0.     0.  ]
 [219.93 538.9  219.93   0.     0.     0.  ]
 [219.93 219.93 538.9    0.     0.     0.  ]
 [  0.     0.     0.   178.8    0.     0.  ]
 [  0.     0.     0.     0.   178.8    0.  ]
 [  0.     0.     0.     0.     0.   178.8 ]]
C_11 = 538.90 +/- 16.58 GPa
C_12 = 219.93 +/- 12.45 GPa
C_44 = 178.80 +/- 12.70 GPa
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">alat</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> (Angstrom), </span><span class="si">{</span><span class="n">C11</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">C12</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">C44</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> (GPa)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.143 (Angstrom), 538.90, 219.93, 178.80 (GPa)
</pre></div>
</div>
</div>
</div>
<p>The values are in good agreement with corresponding numbers in the paper: 3.143, 523, 202, 161</p>
<section id="screw-dislocation">
<h3>1/2&lt;111&gt;{110} screw dislocation<a class="headerlink" href="#screw-dislocation" title="Permalink to this heading"></a></h3>
<p>The notation 1/2&lt;111&gt;{110} means a dislocation with a burgers vector 1/2&lt;111&gt; and glide plane {110}. For screw dislocation, the dislocation line is parallel to the burgers vector, thus Z direction of the cell will be along &lt;111&gt;. The glide plane {110} fixes the Y direction to be &lt;110&gt; and the X direction is fixed by the geometry to be along &lt;112&gt;. However you do not have to think about it to start since <code class="docutils literal notranslate"><span class="pre">BCCScrew111Dislocation</span></code> object contains all the necessary information. All you need to do is to pass <span class="math notranslate nohighlight">\(a_0\)</span> and elastic constants <span class="math notranslate nohighlight">\(C_{11}\)</span>, <span class="math notranslate nohighlight">\(C_{12}\)</span> and <span class="math notranslate nohighlight">\(C_{44}\)</span> and the symbol of the desired BCC element to the constructor.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matscipy.dislocation</span> <span class="kn">import</span> <span class="n">BCCScrew111Dislocation</span>

<span class="n">W_screw</span> <span class="o">=</span> <span class="n">BCCScrew111Dislocation</span><span class="p">(</span><span class="n">alat</span><span class="p">,</span> <span class="n">C11</span><span class="p">,</span> <span class="n">C12</span><span class="p">,</span> <span class="n">C44</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;W&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cell orientation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_screw</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Burgers vector:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_screw</span><span class="o">.</span><span class="n">burgers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cell orientation:
[[ 1  1 -2]
 [-1  1  0]
 [ 1  1  1]]
Burgers vector:
[1.57169453 1.57169453 1.57169453]
</pre></div>
</div>
</div>
</div>
<p>We are going to use <code class="docutils literal notranslate"><span class="pre">BCCScrew111Dislocation.build_cylinder()</span></code> method to build the cells. All the necessary parameters are passed automatically and we only need to chose the radius of the cell in (X,Y) plane. The function returns reference bulk cell and a cell containing dislocation. The displacement field is applied iteratively until a converged value is achieved, the printed output shows the difference between the steps. The radius provided is a parameter is a radius of unconstrained region around the core. The outer shell of fixed atoms is added on top of this. The default value is 10 Angstrom which is about two times larger than the cutoff for the used interatomic potential. The information about which atoms are fixed is stored in <code class="docutils literal notranslate"><span class="pre">fix_mask</span></code> array and can be accessed via <code class="docutils literal notranslate"><span class="pre">W_screw_dislo.get_array('fix_mask')</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W_screw_bulk</span><span class="p">,</span> <span class="n">W_screw_dislo</span> <span class="o">=</span> <span class="n">W_screw</span><span class="o">.</span><span class="n">build_cylinder</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Cell vectors:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_screw_dislo</span><span class="o">.</span><span class="n">cell</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Burgers vector lenth: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">W_screw</span><span class="o">.</span><span class="n">burgers</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Angstrom&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>disloc SCF 0 |d1-d2|_inf = 0.001400723332078968
disloc SCF 1 |d1-d2|_inf = 6.704394990092455e-06
disloc SCF 2 |d1-d2|_inf = 3.2089362583809233e-08

Cell vectors:
[[61.59759392  0.          0.        ]
 [ 0.         62.235928    0.        ]
 [ 0.          0.          2.72225477]]

Burgers vector lenth: 2.72 Angstrom
</pre></div>
</div>
</div>
</div>
<p>Now we can look at the created structure with the interactive view. Hovering your mouse over an atom will show chemical symbol of the atom and the structure identified by CNA algorithm. Dislocation is shown with an arrow corresponding to the dislocation line vector <span class="math notranslate nohighlight">\(\vec l\)</span>. Hovering over the dislocation will display the dislocation name. Moreover, you can use your mouse to control the view:</p>
<ul class="simple">
<li><p>Translation: right click + drag</p></li>
<li><p>Rotation: left click + drag</p></li>
<li><p>Z-axis rotation: Ctrl + right click + drag</p></li>
<li><p>Zoom: scroll wheel</p></li>
<li><p>Center view: left click on the desired atom</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_dislocation</span><span class="p">(</span><span class="n">W_screw_dislo</span><span class="p">,</span> <span class="n">d_name</span><span class="o">=</span><span class="s2">&quot;1/2&lt;111&gt; screw&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "df6d21351f824d99bd4ec008cc1417bc", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p>It can be seen that most of the cell is identified as BCC structure with some grey atoms identified as <em>Other</em>. These atoms represent the defect atoms, where the algorithm could not assign a crystallographic structure. In this case we have defect atoms at the dislocation core and on the artificial free surfaces on the edges of the cell. The atoms at the <em>surface</em> are part of fixed region of the cell.</p>
<p>Here we have a cell with the length of one Burgers vector <span class="math notranslate nohighlight">\(|\vec b| = \frac{\sqrt{3}}{2}a_0\)</span> along the dislocation line. With the periodic boundary conditions along Z, it corresponds to infinitely long straight dislocation line. Note that the periodic boundary conditions along the dislocation line are not applied in the visualisation. It makes it easier to see the displacement, but you might notice the atoms outside the simulation box.</p>
<p>To increase the size of the cell along the line we can rely on the magic of <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/">ASE</a> and simply multiply the cell.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">longer_W_screw_dislo</span> <span class="o">=</span> <span class="n">W_screw_dislo</span> <span class="o">*</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">show_dislocation</span><span class="p">(</span><span class="n">longer_W_screw_dislo</span><span class="p">,</span> <span class="n">d_name</span><span class="o">=</span><span class="s2">&quot;1/2&lt;111&gt; screw&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3645f686ef254210bd8007af69ca5ea2", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p>If you want to save the configuration in a file for further analysis or as an input for a code you can use build in <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/ase/io/io.html#ase.io.write">ASE write method</a> as <code class="docutils literal notranslate"><span class="pre">longer_W_screw_dislo.write(filename)</span></code>. The method supports a wide range of formats including <code class="docutils literal notranslate"><span class="pre">xyz</span></code> and LAMMPS data files. Do not forget to take into account fixed atoms if you use the saved file as an input for a simulation code like LAMMPS.</p>
</section>
<section id="edge-dislocation">
<h3>1/2&lt;111&gt;{110} edge dislocation<a class="headerlink" href="#edge-dislocation" title="Permalink to this heading"></a></h3>
<p>As we said before, for edge dislocations burgers vectpr <span class="math notranslate nohighlight">\(\vec b\)</span> is perpendicular to the dislocation <span class="math notranslate nohighlight">\(\vec l\)</span>. So here, we have the same glide plane of (110) which fixes the cell Y direction to &lt;110&gt;. X direction now will be along burgers vector &lt;111&gt; and Z dislocation line direction &lt;112&gt;.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matscipy.dislocation</span> <span class="kn">import</span> <span class="n">BCCEdge111Dislocation</span>

<span class="n">W_edge</span> <span class="o">=</span> <span class="n">BCCEdge111Dislocation</span><span class="p">(</span><span class="n">alat</span><span class="p">,</span> <span class="n">C11</span><span class="p">,</span> <span class="n">C12</span><span class="p">,</span> <span class="n">C44</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;W&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cell orientation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_edge</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Burgers vector:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_edge</span><span class="o">.</span><span class="n">burgers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cell orientation:
[[ 1  1  1]
 [ 1 -1  0]
 [ 1  1 -2]]
Burgers vector:
[1.57169453 1.57169453 1.57169453]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W_edge_bulk</span><span class="p">,</span> <span class="n">W_edge_dislo</span> <span class="o">=</span> <span class="n">W_edge</span><span class="o">.</span><span class="n">build_cylinder</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Cell vectors:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_edge_dislo</span><span class="o">.</span><span class="n">cell</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Burgers vector lenth: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">W_edge</span><span class="o">.</span><span class="n">burgers</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Angstrom&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>disloc SCF 0 |d1-d2|_inf = 0.17503717189385382
disloc SCF 1 |d1-d2|_inf = 0.030669651063355258
disloc SCF 2 |d1-d2|_inf = 0.004376489640269432
disloc SCF 3 |d1-d2|_inf = 0.0008807112000284167
disloc SCF 4 |d1-d2|_inf = 0.00015452837692353505
disloc SCF 5 |d1-d2|_inf = 2.6112647029508107e-05
disloc SCF 6 |d1-d2|_inf = 5.7487804006051135e-06
disloc SCF 7 |d1-d2|_inf = 7.771108773702018e-07

Cell vectors:
[[54.44509545  0.          0.        ]
 [ 0.         53.34508114  0.        ]
 [ 0.          0.          7.69969924]]

Burgers vector lenth: 2.72 Angstrom
</pre></div>
</div>
</div>
</div>
<p>It can be seen from the print output of <code class="docutils literal notranslate"> <span class="pre">W_edge.build_cylinder()</span></code> that the case of edge dislocation the requires more iterations to achieve converged displacement field.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_dislocation</span><span class="p">(</span><span class="n">W_edge_dislo</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">d_name</span><span class="o">=</span><span class="s2">&quot;1/2&lt;111&gt; edge&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "863a61925a3c4d8ca4de13786507f13c", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="mixed-dislocation">
<h3>1/2&lt;111&gt;{110} mixed dislocation<a class="headerlink" href="#mixed-dislocation" title="Permalink to this heading"></a></h3>
<p>For mixed dislocation the cell vector are the same as for the screw dislocation. The difference is that the displacement vector is applied along &lt;111&gt; direction that is not parallel to the Z direction: [<span class="math notranslate nohighlight">\(1\bar 11\)</span>] and [<span class="math notranslate nohighlight">\(1\bar 1 \bar1\)</span>] with an angle of 70.5 degrees between the vectors. This leads to both edge and screw component in the displacement and thus the name <em>mixed</em> dislocation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matscipy.dislocation</span> <span class="kn">import</span> <span class="n">BCCMixed111Dislocation</span>

<span class="n">W_mixed</span> <span class="o">=</span> <span class="n">BCCMixed111Dislocation</span><span class="p">(</span><span class="n">alat</span><span class="p">,</span> <span class="n">C11</span><span class="p">,</span> <span class="n">C12</span><span class="p">,</span> <span class="n">C44</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;W&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cell orientation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_mixed</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Burgers vector:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_mixed</span><span class="o">.</span><span class="n">burgers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cell orientation:
[[ 1 -1 -2]
 [ 1  1  0]
 [ 1 -1  1]]
Burgers vector:
[ 1.57169453 -1.57169453 -1.57169453]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W_mixed_bulk</span><span class="p">,</span> <span class="n">W_mixed_dislo</span> <span class="o">=</span> <span class="n">W_mixed</span><span class="o">.</span><span class="n">build_cylinder</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Cell vectors:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_mixed_dislo</span><span class="o">.</span><span class="n">cell</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Burgers vector length: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">W_mixed</span><span class="o">.</span><span class="n">burgers</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Angstrom&quot;</span><span class="p">)</span>

<span class="n">show_dislocation</span><span class="p">(</span><span class="n">W_mixed_dislo</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">d_name</span><span class="o">=</span><span class="s2">&quot;1/2&lt;111&gt; mixed&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>disloc SCF 0 |d1-d2|_inf = 0.10539187767041772
disloc SCF 1 |d1-d2|_inf = 0.018105716735450528
disloc SCF 2 |d1-d2|_inf = 0.002853744720166418
disloc SCF 3 |d1-d2|_inf = 0.00044617599789692486
disloc SCF 4 |d1-d2|_inf = 6.968641396387643e-05
disloc SCF 5 |d1-d2|_inf = 1.0882499856867955e-05
disloc SCF 6 |d1-d2|_inf = 1.6994203833053945e-06
disloc SCF 7 |d1-d2|_inf = 2.653822296916353e-07

Cell vectors:
[[61.59759392  0.          0.        ]
 [ 0.         62.235928    0.        ]
 [ 0.          0.          2.72225477]]

Burgers vector length: 2.72 Angstrom
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c8e63ead26fc406590892d6e8897f0d0", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="edge-junction-dislocation">
<h3>&lt;100&gt;{110} edge ‘junction’ dislocation<a class="headerlink" href="#edge-junction-dislocation" title="Permalink to this heading"></a></h3>
<p>So called junction dislocations with burdgers vector along &lt;100&gt; can be formed in the reactions between more abundant dislocations with burgers vector 1/2&lt;111&gt; such as:</p>
<div class="math notranslate nohighlight">
\[
    \frac{1}{2}[1\bar{1}1] + \frac{1}{2}[11\bar{1}] = [100]
\]</div>
<p>They share the same glide plane ad 1/2&lt;111&gt; dislocations and can play important role in impurity segregation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matscipy.dislocation</span> <span class="kn">import</span> <span class="n">BCCEdge100110Dislocation</span>

<span class="n">W_100110_edge</span> <span class="o">=</span> <span class="n">BCCEdge100110Dislocation</span><span class="p">(</span><span class="n">alat</span><span class="p">,</span> <span class="n">C11</span><span class="p">,</span> <span class="n">C12</span><span class="p">,</span> <span class="n">C44</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;W&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cell orientation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_100110_edge</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Burgers vector:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_100110_edge</span><span class="o">.</span><span class="n">burgers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cell orientation:
[[ 1  0  0]
 [ 0  1  1]
 [ 0 -1  1]]
Burgers vector:
[3.14338905 0.         0.        ]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W_100110_edge_bulk</span><span class="p">,</span> <span class="n">W_100110_edge_dislo</span> <span class="o">=</span> <span class="n">W_100110_edge</span><span class="o">.</span><span class="n">build_cylinder</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
<span class="n">show_dislocation</span><span class="p">(</span><span class="n">W_100110_edge_dislo</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> 
                 <span class="n">d_name</span><span class="o">=</span><span class="s2">&quot;&lt;100&gt;</span><span class="si">{110}</span><span class="s2"> edge&quot;</span><span class="p">,</span> <span class="n">d_color</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>disloc SCF 0 |d1-d2|_inf = 0.256011923011219
disloc SCF 1 |d1-d2|_inf = 0.06016875789278883
disloc SCF 2 |d1-d2|_inf = 0.008688239875985548
disloc SCF 3 |d1-d2|_inf = 0.002036859690120879
disloc SCF 4 |d1-d2|_inf = 0.00025500641555943615
disloc SCF 5 |d1-d2|_inf = 8.302194247189476e-05
disloc SCF 6 |d1-d2|_inf = 1.6579146270331857e-05
disloc SCF 7 |d1-d2|_inf = 1.7272275882884713e-06
disloc SCF 8 |d1-d2|_inf = 6.753932630942927e-07
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "97a6a8aa8305419b802a254b534dcf62", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="id1">
<h3>&lt;100&gt;{001} edge dislocation<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h3>
<p>This is the same junction dislocation but lying in a different glide plane: (001).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matscipy.dislocation</span> <span class="kn">import</span> <span class="n">BCCEdge100Dislocation</span>

<span class="n">W_100_edge</span> <span class="o">=</span> <span class="n">BCCEdge100Dislocation</span><span class="p">(</span><span class="n">alat</span><span class="p">,</span> <span class="n">C11</span><span class="p">,</span> <span class="n">C12</span><span class="p">,</span> <span class="n">C44</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;W&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cell orientation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_100_edge</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Burgers vector:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_100_edge</span><span class="o">.</span><span class="n">burgers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cell orientation:
[[ 1  0  0]
 [ 0  0 -1]
 [ 0  1  0]]
Burgers vector:
[3.14338905 0.         0.        ]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W_100_edge_bulk</span><span class="p">,</span> <span class="n">W_100_edge_dislo</span> <span class="o">=</span> <span class="n">W_100_edge</span><span class="o">.</span><span class="n">build_cylinder</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">show_dislocation</span><span class="p">(</span><span class="n">W_100_edge_dislo</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">d_name</span><span class="o">=</span><span class="s2">&quot;&lt;100&gt;</span><span class="si">{001}</span><span class="s2"> edge&quot;</span><span class="p">,</span> <span class="n">d_color</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>disloc SCF 0 |d1-d2|_inf = 0.29723896079013645
disloc SCF 1 |d1-d2|_inf = 0.03893895819760007
disloc SCF 2 |d1-d2|_inf = 0.011189961805871729
disloc SCF 3 |d1-d2|_inf = 0.001492901691747324
disloc SCF 4 |d1-d2|_inf = 0.00046542738716470744
disloc SCF 5 |d1-d2|_inf = 8.162136711258039e-05
disloc SCF 6 |d1-d2|_inf = 1.3593036747305831e-05
disloc SCF 7 |d1-d2|_inf = 4.370960947186475e-06
disloc SCF 8 |d1-d2|_inf = 5.007713447316431e-07
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f3c5f9df4a574110902f9da11ff7372f", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
</section>
<section id="face-centered-cubic">
<h2>Face Centered Cubic<a class="headerlink" href="#face-centered-cubic" title="Permalink to this heading"></a></h2>
<p>As an example of FCC material we will consider Ni and an interatomic potential from <a class="reference external" href="https://www.tandfonline.com/doi/abs/10.1080/14786430903299824">Bonny <em>et. al.</em></a></p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eam_calc</span> <span class="o">=</span> <span class="n">EAM</span><span class="p">(</span><span class="s2">&quot;../../tests/FeCuNi.eam.alloy&quot;</span><span class="p">)</span>

<span class="c1"># the function accepts any ASE type of calculator</span>
<span class="n">alat</span><span class="p">,</span> <span class="n">C11</span><span class="p">,</span> <span class="n">C12</span><span class="p">,</span> <span class="n">C44</span> <span class="o">=</span> <span class="n">get_elastic_constants</span><span class="p">(</span><span class="n">calculator</span><span class="o">=</span><span class="n">eam_calc</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;Ni&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      Step     Time          Energy         fmax
*Force-consistent energies used in optimization.
FIRE:    0 15:30:04      -17.801046*       0.0001
Fitting C_11
Strain array([-0.02, -0.01,  0.  ,  0.01,  0.02])
Stress array([-5.12800014e+00, -2.50333320e+00, -1.41366167e-04,  2.37961959e+00,
        4.63379565e+00]) GPa
Cij (gradient) / GPa    :     244.0654437182867
Error in Cij / GPa      :     4.217968506243491
Correlation coefficient :     0.9995522932872427
Setting C11 (1) to 1.523337 +/- 0.026326


Fitting C_21
Strain array([-0.02, -0.01,  0.  ,  0.01,  0.02])
Stress array([-3.37539886e+00, -1.58459192e+00, -1.41366167e-04,  1.38619385e+00,
        2.58171226e+00]) GPa
Cij (gradient) / GPa    :     148.85008009740656
Error in Cij / GPa      :     6.776719382842348
Correlation coefficient :     0.9969053432709588
Setting C21 (7) to 0.929049 +/- 0.042297


Fitting C_31
Strain array([-0.02, -0.01,  0.  ,  0.01,  0.02])
Stress array([-3.37539886e+00, -1.58459192e+00, -1.41366167e-04,  1.38619385e+00,
        2.58171226e+00]) GPa
Cij (gradient) / GPa    :     148.850080097406
Error in Cij / GPa      :     6.776719382842323
Correlation coefficient :     0.9969053432709588
Updating C31 (7) with value 0.929049 +/- 0.042297


Fitting C_44
Strain array([-0.02, -0.01,  0.  ,  0.01,  0.02])
Stress array([-2.51031965e+00, -1.25545671e+00, -2.54901650e-17,  1.25652507e+00,
        2.51470655e+00]) GPa
Cij (gradient) / GPa    :     125.62034171207866
Error in Cij / GPa      :     0.0380968152678079
Correlation coefficient :     0.9999998620414655
Setting C44 (4) to 0.784061 +/- 0.000238


[[b C11 b C12 b C12 b     b     b    ]
 [b C12 b C11 b C12 b     b     b    ]
 [b C12 b C12 b C11 b     b     b    ]
 [b     b     b     b C44 b     b    ]
 [b     b     b     b     b C44 b    ]
 [b     b     b     b     b     b C44]]

 = 

[[244.07 148.85 148.85   0.     0.     0.  ]
 [148.85 244.07 148.85   0.     0.     0.  ]
 [148.85 148.85 244.07   0.     0.     0.  ]
 [  0.     0.     0.   125.62   0.     0.  ]
 [  0.     0.     0.     0.   125.62   0.  ]
 [  0.     0.     0.     0.     0.   125.62]]
C_11 = 244.07 +/- 4.22 GPa
C_12 = 148.85 +/- 6.78 GPa
C_44 = 125.62 +/- 0.04 GPa
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">alat</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> (Angstrom), </span><span class="si">{</span><span class="n">C11</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">C12</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">C44</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> (GPa)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.520 (Angstrom), 244.07, 148.85, 125.62 (GPa)
</pre></div>
</div>
</div>
</div>
<section id="screw-dislocation-perfect-and-dissociated">
<h3>1/2&lt;110&gt;{111} screw dislocation (perfect and dissociated)<a class="headerlink" href="#screw-dislocation-perfect-and-dissociated" title="Permalink to this heading"></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matscipy.dislocation</span> <span class="kn">import</span> <span class="n">FCCScrew110Dislocation</span>

<span class="n">Ni_screw</span> <span class="o">=</span> <span class="n">FCCScrew110Dislocation</span><span class="p">(</span><span class="n">alat</span><span class="p">,</span> <span class="n">C11</span><span class="p">,</span> <span class="n">C12</span><span class="p">,</span> <span class="n">C44</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;Ni&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cell orientation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Ni_screw</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Burgers vector:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Ni_screw</span><span class="o">.</span><span class="n">burgers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cell orientation:
[[ 1  1 -2]
 [ 1  1  1]
 [ 1 -1  0]]
Burgers vector:
[ 1.76 -1.76  0.  ]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ni_screw_bulk</span><span class="p">,</span> <span class="n">Ni_screw_dislo</span> <span class="o">=</span> <span class="n">Ni_screw</span><span class="o">.</span><span class="n">build_cylinder</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Cell vectors:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Ni_screw_dislo</span><span class="o">.</span><span class="n">cell</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Burgers vector length: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Ni_screw</span><span class="o">.</span><span class="n">burgers</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Angstrom&quot;</span><span class="p">)</span>

<span class="n">show_dislocation</span><span class="p">(</span><span class="n">Ni_screw_dislo</span><span class="p">,</span> 
                 <span class="n">d_name</span><span class="o">=</span><span class="s2">&quot;1/2&lt;110&gt; screw dislocation line&quot;</span><span class="p">,</span> 
                 <span class="n">d_color</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>disloc SCF 0 |d1-d2|_inf = 0.021791458261984697
disloc SCF 1 |d1-d2|_inf = 0.0002936041882874109
disloc SCF 2 |d1-d2|_inf = 4.8928735380371347e-05
disloc SCF 3 |d1-d2|_inf = 1.2696678054050815e-06
disloc SCF 4 |d1-d2|_inf = 1.0764587210498888e-07
disloc SCF 0 |d1-d2|_inf = 0.020321133865591423
disloc SCF 1 |d1-d2|_inf = 0.0006134137472214689
disloc SCF 2 |d1-d2|_inf = 5.9406489367308524e-05
disloc SCF 3 |d1-d2|_inf = 2.948341477265748e-06
disloc SCF 4 |d1-d2|_inf = 8.340714410803862e-08

Cell vectors:
[[60.35542726  0.          0.        ]
 [ 0.         60.96818843  0.        ]
 [ 0.          0.          2.48901587]]

Burgers vector length: 2.49 Angstrom
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c4f9f14bc6c84ecebe6c05988046b9d6", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p>Due to stable Intrinsic Stacking Fault (ISF) the 1/2&lt;110&gt; dislocations are not stable and dissociate in two 1/6&lt;112&gt; Shockley partials separated by stacking fault. For example:</p>
<div class="math notranslate nohighlight">
\[
    \frac{1}{2}[1\bar10] \rightarrow \frac{1}{6}[2\bar1\bar1] + \mathrm{ISF} + \frac{1}{2}[1\bar21]
\]</div>
<p>where ISF is intrinsic stacking fault. It is possible to pass a parameter <code class="docutils literal notranslate"><span class="pre">partial_distance</span></code> to <code class="docutils literal notranslate"><span class="pre">build_cylinder()</span></code> function in order to create dissociated dislocation. <code class="docutils literal notranslate"><span class="pre">partial</span> <span class="pre">distance</span></code> defines separation distance (length of the stacking fault) of two partial dislocations. The value corresponds to number of glide distances the distance in Angstrom be obtaines as <code class="docutils literal notranslate"><span class="pre">patial_distance</span> <span class="pre">*</span> <span class="pre">dislocation.glide_distance</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ni_screw_bulk</span><span class="p">,</span> <span class="n">Ni_screw_dislo</span> <span class="o">=</span> <span class="n">Ni_screw</span><span class="o">.</span><span class="n">build_cylinder</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">partial_distance</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Expected partial distance: </span><span class="si">{</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Ni_screw</span><span class="o">.</span><span class="n">glide_distance</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> Angstrom&quot;</span><span class="p">)</span>
<span class="n">show_dislocation</span><span class="p">(</span><span class="n">Ni_screw_dislo</span><span class="p">,</span> 
                 <span class="n">partial_distance</span><span class="o">=</span><span class="mi">5</span> <span class="o">*</span> <span class="n">Ni_screw</span><span class="o">.</span><span class="n">glide_distance</span><span class="p">,</span>
                 <span class="n">d_name</span><span class="o">=</span><span class="s2">&quot;1/6&lt;112&gt; Shockley partial screw&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>disloc SCF 0 |d1-d2|_inf = 0.02179145826198453
disloc SCF 1 |d1-d2|_inf = 0.0002936041882874109
disloc SCF 2 |d1-d2|_inf = 4.892873538059339e-05
disloc SCF 3 |d1-d2|_inf = 1.2696678051752307e-06
disloc SCF 4 |d1-d2|_inf = 1.0764587193845543e-07
disloc SCF 0 |d1-d2|_inf = 0.020321133865591506
disloc SCF 1 |d1-d2|_inf = 0.0006134137472214689
disloc SCF 2 |d1-d2|_inf = 5.9406489367308524e-05
disloc SCF 3 |d1-d2|_inf = 2.948341477515548e-06
disloc SCF 4 |d1-d2|_inf = 8.340714444804442e-08

Expected partial distance: 10.8 Angstrom
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "edb77f22bec7476bb0cce5beb1723915", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p>Together with FCC (green) and defect atoms (grey) the CNA algorithm identified the atoms of the stacking fault as HCP structure (pink), which is a result of the local change of stacking order of the atomic layers within the defect.</p>
</section>
<section id="edge-dislocation-perfect-and-dissociated">
<h3>1/2&lt;110&gt;{111} edge dislocation (perfect and dissociated)<a class="headerlink" href="#edge-dislocation-perfect-and-dissociated" title="Permalink to this heading"></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matscipy.dislocation</span> <span class="kn">import</span> <span class="n">FCCEdge110Dislocation</span>

<span class="n">Ni_edge</span> <span class="o">=</span> <span class="n">FCCEdge110Dislocation</span><span class="p">(</span><span class="n">alat</span><span class="p">,</span> <span class="n">C11</span><span class="p">,</span> <span class="n">C12</span><span class="p">,</span> <span class="n">C44</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;Ni&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cell orientation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Ni_edge</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Burgers vector:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Ni_edge</span><span class="o">.</span><span class="n">burgers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cell orientation:
[[ 1 -1  0]
 [ 1  1  1]
 [-1 -1  2]]
Burgers vector:
[ 1.76 -1.76  0.  ]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ni_edge_bulk</span><span class="p">,</span> <span class="n">Ni_edge_dislo</span> <span class="o">=</span> <span class="n">Ni_edge</span><span class="o">.</span><span class="n">build_cylinder</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Cell vectors:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Ni_edge_dislo</span><span class="o">.</span><span class="n">cell</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Burgers vector length: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Ni_edge</span><span class="o">.</span><span class="n">burgers</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Angstrom&quot;</span><span class="p">)</span>

<span class="n">show_dislocation</span><span class="p">(</span><span class="n">Ni_edge_dislo</span><span class="p">,</span> <span class="n">d_name</span><span class="o">=</span><span class="s2">&quot;1/2&lt;110&gt; edge&quot;</span><span class="p">,</span> <span class="n">d_color</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>disloc SCF 0 |d1-d2|_inf = 0.04310715442453525
disloc SCF 1 |d1-d2|_inf = 0.0031359890399249857
disloc SCF 2 |d1-d2|_inf = 0.00018078113282300745
disloc SCF 3 |d1-d2|_inf = 1.4501349156037513e-05
disloc SCF 4 |d1-d2|_inf = 9.978781161934513e-07
disloc SCF 0 |d1-d2|_inf = 0.03462421627571943
disloc SCF 1 |d1-d2|_inf = 0.0022123322463467043
disloc SCF 2 |d1-d2|_inf = 0.00021564683900149317
disloc SCF 3 |d1-d2|_inf = 1.1838612354972411e-05
disloc SCF 4 |d1-d2|_inf = 6.324895580611667e-07

Cell vectors:
[[64.71441261  0.          0.        ]
 [ 0.         60.96818843  0.        ]
 [ 0.          0.          4.31110195]]

Burgers vector length: 2.49 Angstrom
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1329680a67d3459ca901a4ccb7c66955", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ni_edge_bulk</span><span class="p">,</span> <span class="n">Ni_edge_dislo</span> <span class="o">=</span> <span class="n">Ni_edge</span><span class="o">.</span><span class="n">build_cylinder</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">partial_distance</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Expected partial distance: </span><span class="si">{</span><span class="mi">10</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Ni_edge</span><span class="o">.</span><span class="n">glide_distance</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> Angstrom&quot;</span><span class="p">)</span>
<span class="n">show_dislocation</span><span class="p">(</span><span class="n">Ni_edge_dislo</span><span class="p">,</span> 
                 <span class="n">partial_distance</span><span class="o">=</span><span class="mi">10</span> <span class="o">*</span> <span class="n">Ni_edge</span><span class="o">.</span><span class="n">glide_distance</span><span class="p">,</span> 
                 <span class="n">d_name</span><span class="o">=</span><span class="s2">&quot;1/2&lt;110&gt; Shockley partial edge&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>disloc SCF 0 |d1-d2|_inf = 0.04310715442453525
disloc SCF 1 |d1-d2|_inf = 0.0031359890399249857
disloc SCF 2 |d1-d2|_inf = 0.00018078113282300745
disloc SCF 3 |d1-d2|_inf = 1.4501349155759957e-05
disloc SCF 4 |d1-d2|_inf = 9.978781162003902e-07
disloc SCF 0 |d1-d2|_inf = 0.03462421627571943
disloc SCF 1 |d1-d2|_inf = 0.002212332246347065
disloc SCF 2 |d1-d2|_inf = 0.00021564683900149317
disloc SCF 3 |d1-d2|_inf = 1.1838612354972411e-05
disloc SCF 4 |d1-d2|_inf = 6.324895580611667e-07
Expected partial distance: 12.4 Angstrom
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "cbffabd9c6eb418f91e58d021cd4912e", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
</section>
<section id="diamond-cubic">
<h2>Diamond Cubic<a class="headerlink" href="#diamond-cubic" title="Permalink to this heading"></a></h2>
<p>As an example of diamond structure we will use Si and potential from <a class="reference external" href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.80.746">work of D. Holland and M. Marder</a>.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matscipy.calculators.manybody.explicit_forms.stillinger_weber</span> <span class="kn">import</span> <span class="n">StillingerWeber</span><span class="p">,</span>\
                                                                <span class="n">Holland_Marder_PRL_80_746_Si</span>
<span class="kn">from</span> <span class="nn">matscipy.calculators.manybody</span> <span class="kn">import</span> <span class="n">Manybody</span>
<span class="n">calc</span> <span class="o">=</span> <span class="n">Manybody</span><span class="p">(</span><span class="o">**</span><span class="n">StillingerWeber</span><span class="p">(</span><span class="n">Holland_Marder_PRL_80_746_Si</span><span class="p">))</span>

<span class="c1"># the function accepts any ASE type of calculator</span>
<span class="n">alat</span><span class="p">,</span> <span class="n">C11</span><span class="p">,</span> <span class="n">C12</span><span class="p">,</span> <span class="n">C44</span> <span class="o">=</span> <span class="n">get_elastic_constants</span><span class="p">(</span><span class="n">calculator</span><span class="o">=</span><span class="n">calc</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;Si&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      Step     Time          Energy         fmax
*Force-consistent energies used in optimization.
FIRE:    0 15:30:06      -34.692786*       0.0922
FIRE:    1 15:30:06      -34.692742*       0.1881
FIRE:    2 15:30:06      -34.692797*       0.0452
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:    3 15:30:06      -34.692771*       0.1323
FIRE:    4 15:30:06      -34.692781*       0.1071
FIRE:    5 15:30:06      -34.692794*       0.0616
FIRE:    6 15:30:06      -34.692800*       0.0043
FIRE:    7 15:30:06      -34.692795*       0.0537
FIRE:    8 15:30:06      -34.692796*       0.0511
FIRE:    9 15:30:06      -34.692796*       0.0461
FIRE:   10 15:30:06      -34.692798*       0.0390
FIRE:   11 15:30:06      -34.692799*       0.0299
FIRE:   12 15:30:06      -34.692799*       0.0195
FIRE:   13 15:30:06      -34.692800*       0.0081
FIRE:   14 15:30:06      -34.692800*       0.0036
FIRE:   15 15:30:06      -34.692800*       0.0036
FIRE:   16 15:30:06      -34.692800*       0.0035
FIRE:   17 15:30:06      -34.692800*       0.0034
FIRE:   18 15:30:06      -34.692800*       0.0032
FIRE:   19 15:30:06      -34.692800*       0.0030
FIRE:   20 15:30:06      -34.692800*       0.0028
FIRE:   21 15:30:06      -34.692800*       0.0025
FIRE:   22 15:30:06      -34.692800*       0.0022
FIRE:   23 15:30:06      -34.692800*       0.0017
FIRE:   24 15:30:06      -34.692800*       0.0013
FIRE:   25 15:30:06      -34.692800*       0.0007
FIRE:   26 15:30:06      -34.692800*       0.0000
Fitting C_11
Strain array([-0.02, -0.01,  0.  ,  0.01,  0.02])
Stress array([-4.18437928e+00, -2.05313584e+00, -2.57946679e-05,  1.97559670e+00,
        3.87433910e+00]) GPa
Cij (gradient) / GPa    :     201.46169296718193
Error in Cij / GPa      :     2.6470882834179283
Correlation coefficient :     0.999741134311275
Setting C11 (1) to 1.257425 +/- 0.016522


Fitting C_21
Strain array([-0.02, -0.01,  0.  ,  0.01,  0.02])
Stress array([-1.13686951e+00, -5.40672589e-01, -2.57946679e-05,  4.89041361e-01,
        9.30285346e-01]) GPa
Cij (gradient) / GPa    :     51.640236590323106
Error in Cij / GPa      :     1.7644327851076396
Correlation coefficient :     0.9982534295801976
Setting C21 (7) to 0.322313 +/- 0.011013


Fitting C_31
Strain array([-0.02, -0.01,  0.  ,  0.01,  0.02])
Stress array([-1.13686951e+00, -5.40672589e-01, -2.57946679e-05,  4.89041361e-01,
        9.30285346e-01]) GPa
Cij (gradient) / GPa    :     51.64023659032299
Error in Cij / GPa      :     1.764432785107523
Correlation coefficient :     0.9982534295801978
Updating C31 (7) with value 0.322313 +/- 0.011013


Fitting C_44
Strain array([-0.02, -0.01,  0.  ,  0.01,  0.02])
Stress array([-2.43911684e+00, -1.19995048e+00,  2.16046225e-14,  1.16236368e+00,
        2.28858547e+00]) GPa
Cij (gradient) / GPa    :     118.17718786807852
Error in Cij / GPa      :     1.2857535435707688
Correlation coefficient :     0.9998224896147394
Setting C44 (4) to 0.737604 +/- 0.008025


[[b C11 b C12 b C12 b     b     b    ]
 [b C12 b C11 b C12 b     b     b    ]
 [b C12 b C12 b C11 b     b     b    ]
 [b     b     b     b C44 b     b    ]
 [b     b     b     b     b C44 b    ]
 [b     b     b     b     b     b C44]]

 = 

[[201.46  51.64  51.64   0.     0.     0.  ]
 [ 51.64 201.46  51.64   0.     0.     0.  ]
 [ 51.64  51.64 201.46   0.     0.     0.  ]
 [  0.     0.     0.   118.18   0.     0.  ]
 [  0.     0.     0.     0.   118.18   0.  ]
 [  0.     0.     0.     0.     0.   118.18]]
C_11 = 201.46 +/- 2.65 GPa
C_12 = 51.64 +/- 1.76 GPa
C_44 = 118.18 +/- 1.29 GPa
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">alat</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> (Angstrom), </span><span class="si">{</span><span class="n">C11</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">C12</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">C44</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> (GPa)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.431 (Angstrom), 201.46, 51.64, 118.18 (GPa)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matscipy.dislocation</span> <span class="kn">import</span> <span class="n">DiamondGlideScrew</span>

<span class="n">Si_screw</span> <span class="o">=</span> <span class="n">DiamondGlideScrew</span><span class="p">(</span><span class="n">alat</span><span class="p">,</span> <span class="n">C11</span><span class="p">,</span> <span class="n">C12</span><span class="p">,</span> <span class="n">C44</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;Si&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cell orientation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Si_screw</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Burgers vector:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Si_screw</span><span class="o">.</span><span class="n">burgers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cell orientation:
[[ 1  1 -2]
 [ 1  1  1]
 [ 1 -1  0]]
Burgers vector:
[ 2.71547466 -2.71547466  0.        ]
</pre></div>
</div>
</div>
</div>
<section id="id2">
<h3>1/2&lt;110&gt;{111} screw dislocation (perfect and dissociated)<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Si_screw_bulk</span><span class="p">,</span> <span class="n">Si_screw_dislo</span> <span class="o">=</span> <span class="n">Si_screw</span><span class="o">.</span><span class="n">build_cylinder</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Cell vectors:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Si_screw_dislo</span><span class="o">.</span><span class="n">cell</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Burgers vector length: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Si_screw</span><span class="o">.</span><span class="n">burgers</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Angstrom&quot;</span><span class="p">)</span>

<span class="n">show_dislocation</span><span class="p">(</span><span class="n">Si_screw_dislo</span><span class="p">,</span> 
                 <span class="n">diamond_structure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">scale</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> 
                 <span class="n">add_bonds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># bonds make it a bit easier to see the structure</span>
                 <span class="n">d_name</span><span class="o">=</span><span class="s2">&quot;1/2&lt;110&gt; screw&quot;</span><span class="p">,</span> 
                 <span class="n">d_color</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cell vectors:
[[66.51527324  0.          0.        ]
 [ 0.         75.25344122  0.        ]
 [ 0.          0.          3.84026109]]

Burgers vector length: 3.84 Angstrom
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f7355f892a57430e9b62045a228e9ac3", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p>The modification of the CNA algorithm for the diamond structure identifies the defect atoms gradually depending how <em>far</em> they are from the perfect structure. The important outcome for us is now dislocation core and free surface atoms are identified as 1st and 2nd neighbors of the <em>Cubic diamond</em> structure.</p>
<p>As in FCC structure similar dissociation mechanism exists in diamond structure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Si_screw_bulk</span><span class="p">,</span> <span class="n">Si_screw_dislo</span> <span class="o">=</span> <span class="n">Si_screw</span><span class="o">.</span><span class="n">build_cylinder</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">partial_distance</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected partial distance: </span><span class="si">{</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Si_screw</span><span class="o">.</span><span class="n">glide_distance</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> Angstrom&quot;</span><span class="p">)</span>
<span class="n">show_dislocation</span><span class="p">(</span><span class="n">Si_screw_dislo</span><span class="p">,</span> 
                 <span class="n">diamond_structure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># bonds make it a bit easier to see the structure</span>
                 <span class="n">scale</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">add_bonds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">partial_distance</span><span class="o">=</span><span class="mi">5</span> <span class="o">*</span> <span class="n">Si_screw</span><span class="o">.</span><span class="n">glide_distance</span><span class="p">,</span> 
                 <span class="n">d_name</span><span class="o">=</span><span class="s2">&quot;1/6&lt;112&gt; 30 degree partial screw&quot;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Expected partial distance: 16.6 Angstrom
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ee85e17cbfb74e9fab64ef50de7c4517", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p>The stacking fault atoms are identified as <em>Hexagonal diamond</em> structure.</p>
</section>
<section id="degree-screw-dislocation-perfect-and-dissociated">
<h3>1/2&lt;110&gt;{111} 60 degree screw dislocation (perfect and dissociated)<a class="headerlink" href="#degree-screw-dislocation-perfect-and-dissociated" title="Permalink to this heading"></a></h3>
<p>Due to the particular symmetry of cubic diamond structure, there exist dislocations with 60 degree angle between burgers vector and dislocation line. This dislocation can dissociate in two partials: 30 and 90 degree.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matscipy.dislocation</span> <span class="kn">import</span> <span class="n">DiamondGlide60Degree</span>

<span class="n">Si_60_degree_screw</span> <span class="o">=</span> <span class="n">DiamondGlide60Degree</span><span class="p">(</span><span class="n">alat</span><span class="p">,</span> <span class="n">C11</span><span class="p">,</span> <span class="n">C12</span><span class="p">,</span> <span class="n">C44</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;Si&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cell orientation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Si_screw</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Burgers vector:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Si_screw</span><span class="o">.</span><span class="n">burgers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cell orientation:
[[ 1  1 -2]
 [ 1  1  1]
 [ 1 -1  0]]
Burgers vector:
[ 2.71547466 -2.71547466  0.        ]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Si_60_degree_screw_bulk</span><span class="p">,</span> \
<span class="n">Si_60_degree_screw_dislo</span> <span class="o">=</span> <span class="n">Si_60_degree_screw</span><span class="o">.</span><span class="n">build_cylinder</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Cell vectors:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Si_60_degree_screw_dislo</span><span class="o">.</span><span class="n">cell</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Burgers vector length: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Si_60_degree_screw</span><span class="o">.</span><span class="n">burgers</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Angstrom&quot;</span><span class="p">)</span>

<span class="n">show_dislocation</span><span class="p">(</span><span class="n">Si_60_degree_screw_dislo</span><span class="p">,</span> 
                 <span class="n">diamond_structure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">scale</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">add_bonds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">d_name</span><span class="o">=</span><span class="s2">&quot;1/2&lt;110&gt; 60 degree screw&quot;</span><span class="p">,</span> 
                 <span class="n">d_color</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cell vectors:
[[66.51527324  0.          0.        ]
 [ 0.         75.25344122  0.        ]
 [ 0.          0.          3.84026109]]

Burgers vector length: 3.84 Angstrom
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8d7eb594109f426e99d12a4a0d60125b", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Si_60_degree_screw_bulk</span><span class="p">,</span> \
<span class="n">Si_60_degree_screw_dislo</span> <span class="o">=</span> <span class="n">Si_60_degree_screw</span><span class="o">.</span><span class="n">build_cylinder</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> 
                                                             <span class="n">partial_distance</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected partial distance: </span><span class="si">{</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Si_60_degree_screw</span><span class="o">.</span><span class="n">glide_distance</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> Angstrom&quot;</span><span class="p">)</span>
<span class="n">show_dislocation</span><span class="p">(</span><span class="n">Si_60_degree_screw_dislo</span><span class="p">,</span> 
                 <span class="n">diamond_structure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">scale</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> 
                 <span class="n">add_bonds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">d_color</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                 <span class="n">partial_distance</span><span class="o">=</span><span class="mi">5</span> <span class="o">*</span> <span class="n">Si_screw</span><span class="o">.</span><span class="n">glide_distance</span><span class="p">,</span> 
                 <span class="n">d_name</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;1/6&lt;112&gt; 90 degree partial screw&quot;</span><span class="p">,</span> 
                         <span class="s2">&quot;1/6&lt;112&gt; 30 degree partial screw&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Expected partial distance: 16.6 Angstrom
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8844142c06074a1ea1d1ceae83239da3", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="plasticity.html" class="btn btn-neutral float-left" title="Plasticity" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="fracture_mechanics.html" class="btn btn-neutral float-right" title="Fracture Mechanics" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, James Kermode, Lars Pastewka, et al.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>