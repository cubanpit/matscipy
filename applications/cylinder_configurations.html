<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Building cylindrical configurations with dislocations &mdash; matscipy devel documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fracture Mechanics" href="fracture_mechanics.html" />
    <link rel="prev" title="Plasticity" href="plasticity.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            matscipy
          </a>
              <div class="version">
                devel
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Matscipy</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Application domains</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="elastic_constants.html">Elastic Constants</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="plasticity.html">Plasticity</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Building cylindrical configurations with dislocations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#body-centered-cubic">Body Centered Cubic</a></li>
<li class="toctree-l4"><a class="reference internal" href="#face-centered-cubic">Face Centered Cubic</a></li>
<li class="toctree-l4"><a class="reference internal" href="#diamond">Diamond</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="fracture_mechanics.html">Fracture Mechanics</a></li>
<li class="toctree-l2"><a class="reference internal" href="tribology.html">Tribology</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">Analysis tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../calculators/index.html">Interatomic potentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">matscipy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Application domains</a></li>
          <li class="breadcrumb-item"><a href="plasticity.html">Plasticity</a></li>
      <li class="breadcrumb-item active">Building cylindrical configurations with dislocations</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/applications/cylinder_configurations.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">matscipy.dislocation</span> <span class="kn">import</span> <span class="n">get_elastic_constants</span><span class="p">,</span> <span class="n">plot_vitek</span>

<span class="kn">from</span> <span class="nn">ase.optimize.precon</span> <span class="kn">import</span> <span class="n">PreconLBFGS</span>

<span class="c1"># interactive visualisation inside the notebook</span>
<span class="kn">from</span> <span class="nn">nglview</span> <span class="kn">import</span> <span class="n">show_ase</span>
<span class="k">def</span> <span class="nf">interactive_view</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="n">view</span> <span class="o">=</span> <span class="n">show_ase</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
    <span class="n">view</span><span class="o">.</span><span class="n">_remove_representation</span><span class="p">()</span>
    <span class="n">view</span><span class="o">.</span><span class="n">add_unitcell</span><span class="p">()</span>
    <span class="n">view</span><span class="o">.</span><span class="n">add_spacefill</span><span class="p">()</span>
    <span class="n">view</span><span class="o">.</span><span class="n">update_spacefill</span><span class="p">(</span><span class="n">radiusType</span><span class="o">=</span><span class="s1">&#39;covalent&#39;</span><span class="p">,</span>
                          <span class="n">radiusScale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>

    <span class="n">view</span><span class="o">.</span><span class="n">camera</span> <span class="o">=</span> <span class="s1">&#39;orthographic&#39;</span>
    <span class="n">view</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;clipDist&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>

    <span class="n">view</span><span class="o">.</span><span class="n">center</span><span class="p">()</span>
    <span class="n">view</span><span class="o">.</span><span class="n">_remote_call</span><span class="p">(</span><span class="s2">&quot;setSize&quot;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;Widget&quot;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;300px&quot;</span><span class="p">,</span> <span class="s2">&quot;300px&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">view</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "3950821e289b4261a6ada93bf6027a54"}</script></div>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="building-cylindrical-configurations-with-dislocations">
<h1>Building cylindrical configurations with dislocations<a class="headerlink" href="#building-cylindrical-configurations-with-dislocations" title="Permalink to this heading"></a></h1>
<p><img alt="" src="../_images/dislocation_cylinder.png" /></p>
<p>The <code class="docutils literal notranslate"><span class="pre">matscipy.dislocation</span></code> provides a set of tools to create atomistic configurations containing dislocations. In this example we focus on cylindrical configurations. In order to create a dislocation we start with a cylinder of bulk material oriented along the vector of the future dislocation line <span class="math notranslate nohighlight">\(\vec l\)</span>. By convention assumed in <code class="docutils literal notranslate"><span class="pre">matscipy.dislocation</span></code> Z direction of the cell always corresponds to the dislocation line <span class="math notranslate nohighlight">\(\vec l\)</span>. Then a displacement field is applied to the cylinder and outer radial shell is fixed in order to stabilise the configuration. So we end up with periodic boundary conditions along the dislocation line (Z) and fixed boundaries along X and Y directions.</p>
<p>Ase shown on the figure above, screw dislocations are characterised by a displacement with corresponding burgers vector <span class="math notranslate nohighlight">\(\vec b\)</span> parallel to the dislocation line <span class="math notranslate nohighlight">\(\vec l\)</span>, while edge dislocations have the burgers vector <span class="math notranslate nohighlight">\(\vec b\)</span> perpendicular to <span class="math notranslate nohighlight">\(\vec l\)</span>. Here we use an anisotrpoic solution within <a class="reference external" href="https://doi.org/10.1080/14786435808565804">Stroh formalism</a> to generate displacement field as implemented in <a class="reference external" href="https://www.ctcms.nist.gov/potentials/atomman/">atomman</a> package. Please note that for this example we use very small systems (small radius). For production calculations one should do a convergence tests with the system size in order to ensure that fixed boundaries do not affect the studied properties.</p>
<section id="body-centered-cubic">
<h2>Body Centered Cubic<a class="headerlink" href="#body-centered-cubic" title="Permalink to this heading"></a></h2>
<p>Here we will use tungsten as an example BCC material. We need lattice parameter <span class="math notranslate nohighlight">\(a_0\)</span> and elastic constants <span class="math notranslate nohighlight">\(C_{11}\)</span>, <span class="math notranslate nohighlight">\(C_{12}\)</span> and <span class="math notranslate nohighlight">\(C_{44}\)</span> to create dislocation configuration. For the case of <em>ab initio</em> calculation one can provide corresponding values directly. For much faster calculations based on interatomic potentials <code class="docutils literal notranslate"><span class="pre">matscipy.dislocation</span></code> provides a convenient method <code class="docutils literal notranslate"><span class="pre">get_elastic_constants</span></code> to calculate desired properties. We will use and Embedded Atom Potential from <a class="reference external" href="http://dx.doi.org/10.1088/0953-8984/25/39/395502">Marinica <em>et. al.</em> 2013 paper</a> (version EAM4) for the case of tungsten.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># the calculator to provide forces and energies from the potential</span>
<span class="kn">from</span> <span class="nn">matscipy.calculators.eam</span> <span class="kn">import</span> <span class="n">EAM</span>
<span class="n">eam_calc</span> <span class="o">=</span> <span class="n">EAM</span><span class="p">(</span><span class="s2">&quot;../../tests/w_eam4.fs&quot;</span><span class="p">)</span>

<span class="c1"># the function accepts any ASE type of calculator</span>
<span class="n">alat</span><span class="p">,</span> <span class="n">C11</span><span class="p">,</span> <span class="n">C12</span><span class="p">,</span> <span class="n">C44</span> <span class="o">=</span> <span class="n">get_elastic_constants</span><span class="p">(</span><span class="n">calculator</span><span class="o">=</span><span class="n">eam_calc</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;W&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      Step     Time          Energy         fmax
*Force-consistent energies used in optimization.
FIRE:    0 13:46:16      -17.792788*       1.5616
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:    1 13:46:16      -17.796007*       1.2330
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:    2 13:46:16      -17.798904*       0.6354
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:    3 13:46:16      -17.799853*       0.2223
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:    4 13:46:16      -17.799882*       0.1976
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:    5 13:46:16      -17.799928*       0.1509
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:    6 13:46:16      -17.799970*       0.0870
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:    7 13:46:16      -17.799991*       0.0130
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:    8 13:46:16      -17.799981*       0.0629
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:    9 13:46:16      -17.799981*       0.0611
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   10 13:46:16      -17.799982*       0.0576
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   11 13:46:16      -17.799984*       0.0525
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   12 13:46:16      -17.799986*       0.0458
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   13 13:46:16      -17.799988*       0.0379
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   14 13:46:16      -17.799989*       0.0289
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   15 13:46:16      -17.799991*       0.0191
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   16 13:46:16      -17.799991*       0.0076
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   17 13:46:16      -17.799992*       0.0052
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   18 13:46:16      -17.799992*       0.0052
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   19 13:46:16      -17.799992*       0.0051
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   20 13:46:16      -17.799992*       0.0049
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   21 13:46:16      -17.799992*       0.0047
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   22 13:46:16      -17.799992*       0.0044
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   23 13:46:16      -17.799992*       0.0041
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   24 13:46:16      -17.799992*       0.0038
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   25 13:46:16      -17.799992*       0.0034
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   26 13:46:16      -17.799992*       0.0028
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   27 13:46:16      -17.799992*       0.0022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   28 13:46:16      -17.799992*       0.0015
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   29 13:46:16      -17.799992*       0.0006
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   30 13:46:16      -17.799992*       0.0003
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   31 13:46:16      -17.799992*       0.0003
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   32 13:46:16      -17.799992*       0.0003
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   33 13:46:16      -17.799992*       0.0003
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   34 13:46:16      -17.799992*       0.0003
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   35 13:46:16      -17.799992*       0.0003
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   36 13:46:16      -17.799992*       0.0003
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   37 13:46:16      -17.799992*       0.0003
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   38 13:46:16      -17.799992*       0.0002
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   39 13:46:16      -17.799992*       0.0002
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   40 13:46:16      -17.799992*       0.0002
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   41 13:46:16      -17.799992*       0.0001
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FIRE:   42 13:46:16      -17.799992*       0.0001
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting C_11
Strain array([-0.02, -0.01,  0.  ,  0.01,  0.02])
Stress array([-1.18143011e+01, -5.57729763e+00, -2.88261126e-04,  4.98286691e+00,
        9.85079614e+00]) GPa
Cij (gradient) / GPa    :     538.9035896451805
Error in Cij / GPa      :     16.584381718776033
Correlation coefficient :     0.9985824334709763
Setting C11 (1) to 3.363572 +/- 0.103512


Fitting C_21
Strain array([-0.02, -0.01,  0.  ,  0.01,  0.02])
Stress array([-5.18171556e+00, -2.29563243e+00, -2.88261126e-04,  1.85153957e+00,
        3.74132626e+00]) GPa
Cij (gradient) / GPa    :     219.93255649330877
Error in Cij / GPa      :     12.450223131451542
Correlation coefficient :     0.9952274688373499
Setting C21 (7) to 1.372711 +/- 0.077708


Fitting C_31
Strain array([-0.02, -0.01,  0.  ,  0.01,  0.02])
Stress array([-5.18171556e+00, -2.29563243e+00, -2.88261126e-04,  1.85153957e+00,
        3.74132626e+00]) GPa
Cij (gradient) / GPa    :     219.93255649330868
Error in Cij / GPa      :     12.450223131451247
Correlation coefficient :     0.9952274688373501
Updating C31 (7) with value 1.372711 +/- 0.077708


Fitting C_44
Strain array([-0.02, -0.01,  0.  ,  0.01,  0.02])
Stress array([-4.37426370e+00, -1.88654647e+00,  9.30635418e-15,  1.43563268e+00,
        2.90478138e+00]) GPa
Cij (gradient) / GPa    :     178.80269302570218
Error in Cij / GPa      :     12.702352202927047
Correlation coefficient :     0.9925146216927534
Setting C44 (4) to 1.115999 +/- 0.079282


[[b C11 b C12 b C12 b     b     b    ]
 [b C12 b C11 b C12 b     b     b    ]
 [b C12 b C12 b C11 b     b     b    ]
 [b     b     b     b C44 b     b    ]
 [b     b     b     b     b C44 b    ]
 [b     b     b     b     b     b C44]]

 = 

[[538.9  219.93 219.93   0.     0.     0.  ]
 [219.93 538.9  219.93   0.     0.     0.  ]
 [219.93 219.93 538.9    0.     0.     0.  ]
 [  0.     0.     0.   178.8    0.     0.  ]
 [  0.     0.     0.     0.   178.8    0.  ]
 [  0.     0.     0.     0.     0.   178.8 ]]
C_11 = 538.90 +/- 16.58 GPa
C_12 = 219.93 +/- 12.45 GPa
C_44 = 178.80 +/- 12.70 GPa
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">alat</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> (Angstrom), </span><span class="si">{</span><span class="n">C11</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">C12</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">C44</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> (GPa)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.143 (Angstrom), 538.90, 219.93, 178.80 (GPa)
</pre></div>
</div>
</div>
</div>
<p>The values are in good agreement with corresponding numbers in the paper: 3.143, 523, 202, 161</p>
<section id="screw-dislocation">
<h3>1/2&lt;111&gt;{110} screw dislocation<a class="headerlink" href="#screw-dislocation" title="Permalink to this heading"></a></h3>
<p>The notation 1/2&lt;111&gt;{110} means a dislocation with a burgers vector 1/2&lt;111&gt; and glide plane {110}. For screw dislocation, the dislocation line is parallel to the burgers vector, thus Z direction of the cell will be along &lt;111&gt;. The glide plane {110} fixes the Y direction to be &lt;110&gt; and the X direction is fixed by the geometry to be along &lt;112&gt;. However you do not have to think about it to start since <code class="docutils literal notranslate"><span class="pre">BCCScrew111Dislocation</span></code> object contains all the necessary information. All you need to do is to pass <span class="math notranslate nohighlight">\(a_0\)</span> and elastic constants <span class="math notranslate nohighlight">\(C_{11}\)</span>, <span class="math notranslate nohighlight">\(C_{12}\)</span> and <span class="math notranslate nohighlight">\(C_{44}\)</span> and the symbol of the desired BCC element to the constructor.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matscipy.dislocation</span> <span class="kn">import</span> <span class="n">BCCScrew111Dislocation</span>

<span class="n">W_screw</span> <span class="o">=</span> <span class="n">BCCScrew111Dislocation</span><span class="p">(</span><span class="n">alat</span><span class="p">,</span> <span class="n">C11</span><span class="p">,</span> <span class="n">C12</span><span class="p">,</span> <span class="n">C44</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;W&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cell orientation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_screw</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Burgers vector:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_screw</span><span class="o">.</span><span class="n">burgers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cell orientation:
[[ 1  1 -2]
 [-1  1  0]
 [ 1  1  1]]
Burgers vector:
[1.57169453 1.57169453 1.57169453]
</pre></div>
</div>
</div>
</div>
<p>We are going to use <code class="docutils literal notranslate"><span class="pre">BCCScrew111Dislocation.build_cylinder()</span></code> method to build the cells. All the necessary parameters are passed automatically and we only need to chose the radius of the cell in (X,Y) plane. The function returns reference bulk cell and a cell containing dislocation. The displacement field is applied iteratively untill a converged value is achieved, the printed output prints the difference between the steps. The radius provided is a parameter is a radius of unconstrained region around the core. The outer shell of fixed atoms is added on top of this. The default value is 10 Angstom which is about two times larger than a cutoff for the used interatomic potential.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W_screw_bulk</span><span class="p">,</span> <span class="n">W_screw_dislo</span> <span class="o">=</span> <span class="n">W_screw</span><span class="o">.</span><span class="n">build_cylinder</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="n">interactive_view</span><span class="p">(</span><span class="n">W_screw_dislo</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Cell vectors:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_screw_dislo</span><span class="o">.</span><span class="n">cell</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Burgers vector lenth:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">W_screw</span><span class="o">.</span><span class="n">burgers</span><span class="p">))</span>

<span class="n">interactive_view</span><span class="p">(</span><span class="n">W_screw_dislo</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>disloc SCF 0 |d1-d2|_inf = 0.0014007233320793289
disloc SCF 1 |d1-d2|_inf = 6.704394989176521e-06
disloc SCF 2 |d1-d2|_inf = 3.2089362944631716e-08

Cell vectors:
[[61.59759392  0.          0.        ]
 [ 0.         62.235928    0.        ]
 [ 0.          0.          2.72225477]]

Burgers vector lenth:
2.722254772666657
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "5563ee89218b4af7901c914a2ce116e7"}</script></div>
</div>
<p>Here we have a cell with <span class="math notranslate nohighlight">\(|\vec b| = \frac{\sqrt{3}}{2}a_0\)</span> length along the dislocation line. With a periodic conditions along Z it corresponds to infinitely long straight dislocation line. Note that the periodic boundary conditions along the dislocation line are not applied in the visualisation. It makes it easier to see the displecement, but you might notice the atoms outside the simulation box.</p>
<p>To increase the size of the cell along the line we can rely on the magic of <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/">ASE</a> and simply multiply the cell.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interactive_view</span><span class="p">(</span><span class="n">W_screw_dislo</span> <span class="o">*</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "a7f0d4b678374cc1b50705a8381e3f19"}</script></div>
</div>
<p>Since fo screw dislocations the displacement is parallel to the dislocation line, it is not easy to see the displacement without 3D tools. Thus so-called differential displacement (Vitek) maps are used to visualise the dislocation core. <code class="docutils literal notranslate"><span class="pre">matscipy.dislocation</span></code> offers a tool called <a class="reference internal" href="../generated/matscipy.dislocation.html#matscipy.dislocation.plot_vitek" title="matscipy.dislocation.plot_vitek"><code class="xref py py-meth docutils literal notranslate"><span class="pre">matscipy.dislocation.plot_vitek()</span></code></a> to build these maps. The colors of the atoms represent three non equivalen planes of W atoms along &lt;111&gt; direction and the arrows represent the difference in displacement of atoms along Z direction. The visualisation below shows so-called compact and symmetric core, which is the most stable for BCC materials.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">plot_vitek</span><span class="p">(</span><span class="n">W_screw_dislo</span><span class="p">,</span> <span class="n">W_screw_bulk</span><span class="p">,</span> <span class="n">alat</span><span class="o">=</span><span class="n">alat</span><span class="p">,</span> <span class="n">xyscale</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">plot_axes</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">W_screw</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> direction ($\AA$)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">W_screw</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> direction ($\AA$)&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/159a1a2de7b12caf84fee79241e99fcb9aeae2da4dfab137f4ab369e5f77070f.png" src="../_images/159a1a2de7b12caf84fee79241e99fcb9aeae2da4dfab137f4ab369e5f77070f.png" />
</div>
</div>
<p>We can use the ASE minimisation tools to minimise the structure using the chosen interatomic potential:</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W_screw_dislo</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">eam_calc</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">PreconLBFGS</span><span class="p">(</span><span class="n">W_screw_dislo</span><span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:   0  13:46:19    -1936.097946       2.5284
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:   1  13:46:21    -1936.291357       0.3596
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:   2  13:46:22    -1936.346476       0.2286
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:   3  13:46:23    -1936.361691       0.6206
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:   4  13:46:24    -1936.374519       0.1534
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:   5  13:46:25    -1936.377157       0.0604
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:   6  13:46:25    -1936.378302       0.0847
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:   7  13:46:27    -1936.378545       0.0449
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:   8  13:46:28    -1936.378652       0.0124
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:   9  13:46:29    -1936.378665       0.0059
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">plot_vitek</span><span class="p">(</span><span class="n">W_screw_dislo</span><span class="p">,</span> <span class="n">W_screw_bulk</span><span class="p">,</span> <span class="n">alat</span><span class="o">=</span><span class="n">alat</span><span class="p">,</span> <span class="n">xyscale</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">plot_axes</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">W_screw</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> direction ($\AA$)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">W_screw</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> direction ($\AA$)&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/212ef8a3e404bb9db934ca669d447841c842adc796b173ab68d8d40ca001b883.png" src="../_images/212ef8a3e404bb9db934ca669d447841c842adc796b173ab68d8d40ca001b883.png" />
</div>
</div>
<p>Differential displacement map of the relaxed structure shows almost the same picture as before with symmetric ‘easy’ dislocation core. This means that for the selected interatomic potential this structure is indeed the most stable and that the initial guess of the displacement was reasonably good.</p>
</section>
<section id="edge-dislocation">
<h3>1/2&lt;111&gt;{110} edge dislocation<a class="headerlink" href="#edge-dislocation" title="Permalink to this heading"></a></h3>
<p>As we said before, for edge dislocations burgers vecort <span class="math notranslate nohighlight">\(\vec b\)</span> is perpendicular to the dislocation <span class="math notranslate nohighlight">\(\vec l\)</span>. So here, we have the same glide plane of (110) which fixes the cell Y direction to &lt;110&gt;. X direction now will be along burgers vector &lt;111&gt; and Z dislocation line direction &lt;112&gt;.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matscipy.dislocation</span> <span class="kn">import</span> <span class="n">BCCEdge111Dislocation</span>

<span class="n">W_edge</span> <span class="o">=</span> <span class="n">BCCEdge111Dislocation</span><span class="p">(</span><span class="n">alat</span><span class="p">,</span> <span class="n">C11</span><span class="p">,</span> <span class="n">C12</span><span class="p">,</span> <span class="n">C44</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;W&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cell orientation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_edge</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Burgers vector:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_edge</span><span class="o">.</span><span class="n">burgers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cell orientation:
[[ 1  1  1]
 [ 1 -1  0]
 [ 1  1 -2]]
Burgers vector:
[1.57169453 1.57169453 1.57169453]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W_edge_bulk</span><span class="p">,</span> <span class="n">W_edge_dislo</span> <span class="o">=</span> <span class="n">W_edge</span><span class="o">.</span><span class="n">build_cylinder</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Cell vectors:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_edge_dislo</span><span class="o">.</span><span class="n">cell</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Burgers vector lenth:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">W_edge</span><span class="o">.</span><span class="n">burgers</span><span class="p">))</span>

<span class="n">interactive_view</span><span class="p">(</span><span class="n">W_edge_dislo</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>disloc SCF 0 |d1-d2|_inf = 0.17503717189387202
disloc SCF 1 |d1-d2|_inf = 0.030669651063356312
disloc SCF 2 |d1-d2|_inf = 0.004376489640269432
disloc SCF 3 |d1-d2|_inf = 0.0008807112000271955
disloc SCF 4 |d1-d2|_inf = 0.00015452837692367383
disloc SCF 5 |d1-d2|_inf = 2.611264702961913e-05
disloc SCF 6 |d1-d2|_inf = 5.748780400383069e-06
disloc SCF 7 |d1-d2|_inf = 7.771108774257129e-07

Cell vectors:
[[54.44509545  0.          0.        ]
 [ 0.         53.34508114  0.        ]
 [ 0.          0.          7.69969924]]

Burgers vector lenth:
2.722254772666657
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "609d2a769f09459e91d9a6f511c1815c"}</script></div>
</div>
<p>It can be seen that the case of edge dislocation the requires more iterations to achieve converged displacement field.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W_edge_dislo</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">eam_calc</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">PreconLBFGS</span><span class="p">(</span><span class="n">W_edge_dislo</span><span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:   0  13:46:31    -3017.104472       5.8264
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:   1  13:46:35    -3017.709557       4.8423
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:   2  13:46:36    -3018.145952       3.6773
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:   3  13:46:37    -3018.510026       2.2950
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:   4  13:46:39    -3018.881181       1.4546
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:   5  13:46:40    -3019.132006       0.7013
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:   6  13:46:41    -3019.257226       0.4936
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:   7  13:46:42    -3019.309721       0.8501
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:   8  13:46:45    -3019.331783       0.4275
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:   9  13:46:47    -3019.340055       0.2540
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:  10  13:46:50    -3019.343848       0.2224
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:  11  13:46:51    -3019.345682       0.3022
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:  12  13:46:52    -3019.347748       0.1698
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:  13  13:46:54    -3019.348742       0.0915
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:  14  13:46:56    -3019.349178       0.0348
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:  15  13:46:57    -3019.349290       0.0489
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:  16  13:46:59    -3019.349394       0.0276
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">W_edge_dislo</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">eam_calc</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">opt</span> <span class="o">=</span> <span class="n">PreconLBFGS</span><span class="p">(</span><span class="n">W_edge_dislo</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="nn">File /usr/local/lib/python3.10/dist-packages/ase/optimize/precon/lbfgs.py:365,</span> in <span class="ni">PreconLBFGS.run</span><span class="nt">(self, fmax, steps, smax)</span>
<span class="g g-Whitespace">    </span><span class="mi">363</span>     <span class="n">smax</span> <span class="o">=</span> <span class="n">fmax</span>
<span class="g g-Whitespace">    </span><span class="mi">364</span> <span class="bp">self</span><span class="o">.</span><span class="n">smax</span> <span class="o">=</span> <span class="n">smax</span>
<span class="ne">--&gt; </span><span class="mi">365</span> <span class="k">return</span> <span class="n">Optimizer</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">steps</span><span class="p">)</span>

<span class="nn">File /usr/local/lib/python3.10/dist-packages/ase/optimize/optimize.py:269,</span> in <span class="ni">Optimizer.run</span><span class="nt">(self, fmax, steps)</span>
<span class="g g-Whitespace">    </span><span class="mi">267</span> <span class="k">if</span> <span class="n">steps</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">268</span>     <span class="bp">self</span><span class="o">.</span><span class="n">max_steps</span> <span class="o">=</span> <span class="n">steps</span>
<span class="ne">--&gt; </span><span class="mi">269</span> <span class="k">return</span> <span class="n">Dynamics</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<span class="nn">File /usr/local/lib/python3.10/dist-packages/ase/optimize/optimize.py:156,</span> in <span class="ni">Dynamics.run</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">149</span> <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">150</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Run dynamics algorithm.</span>
<span class="g g-Whitespace">    </span><span class="mi">151</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">152</span><span class="sd">     This method will return when the forces on all individual</span>
<span class="g g-Whitespace">    </span><span class="mi">153</span><span class="sd">     atoms are less than *fmax* or when the number of steps exceeds</span>
<span class="g g-Whitespace">    </span><span class="mi">154</span><span class="sd">     *steps*.&quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">156</span>     <span class="k">for</span> <span class="n">converged</span> <span class="ow">in</span> <span class="n">Dynamics</span><span class="o">.</span><span class="n">irun</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">157</span>         <span class="k">pass</span>
<span class="g g-Whitespace">    </span><span class="mi">158</span>     <span class="k">return</span> <span class="n">converged</span>

<span class="nn">File /usr/local/lib/python3.10/dist-packages/ase/optimize/optimize.py:135,</span> in <span class="ni">Dynamics.irun</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">131</span> <span class="c1"># run the algorithm until converged or max_steps reached</span>
<span class="g g-Whitespace">    </span><span class="mi">132</span> <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">converged</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">nsteps</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_steps</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">133</span> 
<span class="g g-Whitespace">    </span><span class="mi">134</span>     <span class="c1"># compute the next step</span>
<span class="ne">--&gt; </span><span class="mi">135</span>     <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">136</span>     <span class="bp">self</span><span class="o">.</span><span class="n">nsteps</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="g g-Whitespace">    </span><span class="mi">138</span>     <span class="c1"># let the user inspect the step and change things before logging</span>
<span class="g g-Whitespace">    </span><span class="mi">139</span>     <span class="c1"># and predicting the next step</span>

<span class="nn">File /usr/local/lib/python3.10/dist-packages/ase/optimize/precon/lbfgs.py:246,</span> in <span class="ni">PreconLBFGS.step</span><span class="nt">(self, f)</span>
<span class="g g-Whitespace">    </span><span class="mi">244</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">245</span>     <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">246</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_search</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">previously_reset_hessian</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">247</span> <span class="n">dr</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha_k</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">249</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_k</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>

<span class="nn">File /usr/local/lib/python3.10/dist-packages/ase/optimize/precon/lbfgs.py:327,</span> in <span class="ni">PreconLBFGS.line_search</span><span class="nt">(self, r, g, e, previously_reset_hessian)</span>
<span class="g g-Whitespace">    </span><span class="mi">320</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">321</span>     <span class="c1"># CO: modified call to ls.run</span>
<span class="g g-Whitespace">    </span><span class="mi">322</span>     <span class="c1"># TODO: pass also the old slope to the linesearch</span>
<span class="g g-Whitespace">    </span><span class="mi">323</span>     <span class="c1">#    so that the RumPath can extract a better starting guess?</span>
<span class="g g-Whitespace">    </span><span class="mi">324</span>     <span class="c1">#    alternatively: we can adjust the rotation_factors</span>
<span class="g g-Whitespace">    </span><span class="mi">325</span>     <span class="c1">#    out using some extrapolation tricks?</span>
<span class="g g-Whitespace">    </span><span class="mi">326</span>     <span class="n">ls</span> <span class="o">=</span> <span class="n">LineSearchArmijo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">c1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-14</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">327</span>     <span class="n">step</span><span class="p">,</span> <span class="n">func_val</span><span class="p">,</span> <span class="n">no_update</span> <span class="o">=</span> <span class="n">ls</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">328</span>         <span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">a_min</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a_min</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">329</span>         <span class="n">func_start</span><span class="o">=</span><span class="n">e</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">330</span>         <span class="n">func_prime_start</span><span class="o">=</span><span class="n">g</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">331</span>         <span class="n">func_old</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">e0</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">332</span>         <span class="n">rigid_units</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rigid_units</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">333</span>         <span class="n">rotation_factors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation_factors</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">334</span>         <span class="n">maxstep</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxstep</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">335</span>     <span class="bp">self</span><span class="o">.</span><span class="n">e0</span> <span class="o">=</span> <span class="n">e</span>
<span class="g g-Whitespace">    </span><span class="mi">336</span>     <span class="bp">self</span><span class="o">.</span><span class="n">e1</span> <span class="o">=</span> <span class="n">func_val</span>

<span class="nn">File /usr/local/lib/python3.10/dist-packages/ase/utils/linesearcharmijo.py:297,</span> in <span class="ni">LineSearchArmijo.run</span><span class="nt">(self, x_start, dirn, a_max, a_min, a1, func_start, func_old, func_prime_start, rigid_units, rotation_factors, maxstep)</span>
<span class="g g-Whitespace">    </span><span class="mi">294</span> <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;a1 = </span><span class="si">%e</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">a1</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">296</span> <span class="c1">###CO replaced: func_a1 = self.func(x_start + a1 * self.dirn)</span>
<span class="ne">--&gt; </span><span class="mi">297</span> <span class="n">func_a1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">x_start</span> <span class="o">+</span> <span class="n">path</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">a1</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">298</span> <span class="n">phi_a1</span> <span class="o">=</span> <span class="n">func_a1</span>
<span class="g g-Whitespace">    </span><span class="mi">299</span> <span class="c1"># compute sufficient decrease (Armijo) condition</span>

<span class="nn">File /usr/local/lib/python3.10/dist-packages/ase/optimize/precon/lbfgs.py:302,</span> in <span class="ni">PreconLBFGS.func</span><span class="nt">(self, x)</span>
<span class="g g-Whitespace">    </span><span class="mi">300</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Objective function for use of the optimizers&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">301</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">set_positions</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="ne">--&gt; </span><span class="mi">302</span> <span class="n">potl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">303</span> <span class="k">return</span> <span class="n">potl</span>

<span class="nn">File /usr/local/lib/python3.10/dist-packages/ase/atoms.py:731,</span> in <span class="ni">Atoms.get_potential_energy</span><span class="nt">(self, force_consistent, apply_constraint)</span>
<span class="g g-Whitespace">    </span><span class="mi">728</span>     <span class="n">energy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">729</span>         <span class="bp">self</span><span class="p">,</span> <span class="n">force_consistent</span><span class="o">=</span><span class="n">force_consistent</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">730</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">731</span>     <span class="n">energy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">732</span> <span class="k">if</span> <span class="n">apply_constraint</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">733</span>     <span class="k">for</span> <span class="n">constraint</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span><span class="p">:</span>

<span class="nn">File /usr/local/lib/python3.10/dist-packages/ase/calculators/calculator.py:709,</span> in <span class="ni">Calculator.get_potential_energy</span><span class="nt">(self, atoms, force_consistent)</span>
<span class="g g-Whitespace">    </span><span class="mi">708</span> <span class="k">def</span> <span class="nf">get_potential_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">force_consistent</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">709</span>     <span class="n">energy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;energy&#39;</span><span class="p">,</span> <span class="n">atoms</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">710</span>     <span class="k">if</span> <span class="n">force_consistent</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">711</span>         <span class="k">if</span> <span class="s1">&#39;free_energy&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">:</span>

<span class="nn">File /usr/local/lib/python3.10/dist-packages/ase/calculators/calculator.py:737,</span> in <span class="ni">Calculator.get_property</span><span class="nt">(self, name, atoms, allow_calculation)</span>
<span class="g g-Whitespace">    </span><span class="mi">735</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">allow_calculation</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">736</span>         <span class="k">return</span> <span class="kc">None</span>
<span class="ne">--&gt; </span><span class="mi">737</span>     <span class="bp">self</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="p">[</span><span class="n">name</span><span class="p">],</span> <span class="n">system_changes</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">739</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">740</span>     <span class="c1"># For some reason the calculator was not able to do what we want,</span>
<span class="g g-Whitespace">    </span><span class="mi">741</span>     <span class="c1"># and that is OK.</span>
<span class="g g-Whitespace">    </span><span class="mi">742</span>     <span class="k">raise</span> <span class="n">PropertyNotImplementedError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> not present in this &#39;</span>
<span class="g g-Whitespace">    </span><span class="mi">743</span>                                       <span class="s1">&#39;calculation&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

<span class="nn">File /usr/local/lib/python3.10/dist-packages/matscipy/calculators/eam/calculator.py:212,</span> in <span class="ni">EAM.calculate</span><span class="nt">(self, atoms, properties, system_changes)</span>
<span class="g g-Whitespace">    </span><span class="mi">207</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="n">properties</span><span class="p">,</span> <span class="n">system_changes</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">209</span> <span class="n">i_n</span><span class="p">,</span> <span class="n">j_n</span><span class="p">,</span> <span class="n">dr_nc</span><span class="p">,</span> <span class="n">abs_dr_n</span> <span class="o">=</span> <span class="n">neighbour_list</span><span class="p">(</span><span class="s1">&#39;ijDd&#39;</span><span class="p">,</span> <span class="n">atoms</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">210</span>                                            <span class="bp">self</span><span class="o">.</span><span class="n">_db_cutoff</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">212</span> <span class="n">epot</span><span class="p">,</span> <span class="n">virial_v</span><span class="p">,</span> <span class="n">forces_ic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy_virial_and_forces</span><span class="p">(</span><span class="n">atoms</span><span class="o">.</span><span class="n">numbers</span><span class="p">,</span> <span class="n">i_n</span><span class="p">,</span> <span class="n">j_n</span><span class="p">,</span> <span class="n">dr_nc</span><span class="p">,</span> <span class="n">abs_dr_n</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">214</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;energy&#39;</span><span class="p">:</span> <span class="n">epot</span><span class="p">,</span> <span class="s1">&#39;free_energy&#39;</span><span class="p">:</span> <span class="n">epot</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">215</span>                      <span class="s1">&#39;stress&#39;</span><span class="p">:</span> <span class="n">virial_v</span><span class="o">/</span><span class="n">atoms</span><span class="o">.</span><span class="n">get_volume</span><span class="p">(),</span>
<span class="g g-Whitespace">    </span><span class="mi">216</span>                      <span class="s1">&#39;forces&#39;</span><span class="p">:</span> <span class="n">forces_ic</span><span class="p">})</span>

<span class="nn">File /usr/local/lib/python3.10/dist-packages/matscipy/calculators/eam/calculator.py:168,</span> in <span class="ni">EAM.energy_virial_and_forces</span><span class="nt">(self, atomic_numbers_i, i_n, j_n, dr_nc, abs_dr_n)</span>
<span class="g g-Whitespace">    </span><span class="mi">166</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">mask1</span><span class="p">,</span> <span class="n">atomic_numbers_i</span><span class="p">[</span><span class="n">j_n</span><span class="p">]</span><span class="o">==</span><span class="n">atnum2</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">167</span> <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">168</span>     <span class="n">r</span> <span class="o">=</span> <span class="n">rep</span><span class="p">(</span><span class="n">abs_dr_n</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span><span class="o">/</span><span class="n">abs_dr_n</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">169</span>     <span class="n">rep_n</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span>
<span class="g g-Whitespace">    </span><span class="mi">170</span>     <span class="n">drep_n</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">drep</span><span class="p">(</span><span class="n">abs_dr_n</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span><span class="o">-</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="n">abs_dr_n</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>

<span class="nn">File /usr/local/lib/python3.10/dist-packages/scipy/interpolate/_fitpack2.py:395,</span> in <span class="ni">UnivariateSpline.__call__</span><span class="nt">(self, x, nu, ext)</span>
<span class="g g-Whitespace">    </span><span class="mi">393</span>     <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">394</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unknown extrapolation mode </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">ext</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
<span class="ne">--&gt; </span><span class="mi">395</span> <span class="k">return</span> <span class="n">_fitpack_impl</span><span class="o">.</span><span class="n">splev</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_args</span><span class="p">,</span> <span class="n">der</span><span class="o">=</span><span class="n">nu</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="n">ext</span><span class="p">)</span>

<span class="nn">File /usr/local/lib/python3.10/dist-packages/scipy/interpolate/_fitpack_impl.py:321,</span> in <span class="ni">splev</span><span class="nt">(x, tck, der, ext)</span>
<span class="g g-Whitespace">    </span><span class="mi">319</span> <span class="n">x</span> <span class="o">=</span> <span class="n">atleast_1d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">320</span> <span class="k">if</span> <span class="n">der</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">321</span>     <span class="n">y</span><span class="p">,</span> <span class="n">ier</span> <span class="o">=</span> <span class="n">dfitpack</span><span class="o">.</span><span class="n">splev</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">ext</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">322</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">323</span>     <span class="n">y</span><span class="p">,</span> <span class="n">ier</span> <span class="o">=</span> <span class="n">dfitpack</span><span class="o">.</span><span class="n">splder</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">der</span><span class="p">,</span> <span class="n">ext</span><span class="p">)</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interactive_view</span><span class="p">(</span><span class="n">W_edge_dislo</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ffa1a678356e486d87749676e6ce4f85", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p>It can be seen that relaxed core structure differs significantly from the initial guess.</p>
</section>
<section id="mixed-dislocation">
<h3>1/2&lt;111&gt;{110} mixed dislocation<a class="headerlink" href="#mixed-dislocation" title="Permalink to this heading"></a></h3>
<p>For mixed dislocation the cell vector are the same as for the screw dislocation. However the displacement vector is applied along &lt;111&gt; direction that is not parallel to the Z direction: [<span class="math notranslate nohighlight">\(1\bar 11\)</span>] and [<span class="math notranslate nohighlight">\(1\bar 1 \bar1\)</span>] with an angle of 70.5 degrees between the vectors. This leads to both edge and screw component in the displacement and thus the name <em>mixed</em> dislocation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matscipy.dislocation</span> <span class="kn">import</span> <span class="n">BCCMixed111Dislocation</span>

<span class="n">W_mixed</span> <span class="o">=</span> <span class="n">BCCMixed111Dislocation</span><span class="p">(</span><span class="n">alat</span><span class="p">,</span> <span class="n">C11</span><span class="p">,</span> <span class="n">C12</span><span class="p">,</span> <span class="n">C44</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;W&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cell orientation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_mixed</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Burgers vector:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_mixed</span><span class="o">.</span><span class="n">burgers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cell orientation:
[[ 1 -1 -2]
 [ 1  1  0]
 [ 1 -1  1]]
Burgers vector:
[ 1.57169589 -1.57169589 -1.57169589]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W_mixed_bulk</span><span class="p">,</span> <span class="n">W_mixed_dislo</span> <span class="o">=</span> <span class="n">W_mixed</span><span class="o">.</span><span class="n">build_cylinder</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Cell vectors:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_mixed_dislo</span><span class="o">.</span><span class="n">cell</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Burgers vector lenth:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">W_mixed</span><span class="o">.</span><span class="n">burgers</span><span class="p">))</span>

<span class="n">interactive_view</span><span class="p">(</span><span class="n">W_mixed_dislo</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>disloc SCF 0 |d1-d2|_inf = 0.10539253373490873
disloc SCF 1 |d1-d2|_inf = 0.018105901181897643
disloc SCF 2 |d1-d2|_inf = 0.0028537827503362645
disloc SCF 3 |d1-d2|_inf = 0.0004461832291074441
disloc SCF 4 |d1-d2|_inf = 6.968773949250773e-05
disloc SCF 5 |d1-d2|_inf = 1.0882737324524605e-05
disloc SCF 6 |d1-d2|_inf = 1.6994622201171872e-06
disloc SCF 7 |d1-d2|_inf = 2.6538950442800413e-07

Cell vectors:
[[61.59764738  0.          0.        ]
 [ 0.         62.23598202  0.        ]
 [ 0.          0.          2.72225714]]

Burgers vector lenth:
2.7222571354952314
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e6e8cd4dd3f94b06a921d8bac0bc7c68", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">plot_vitek</span><span class="p">(</span><span class="n">W_mixed_dislo</span><span class="p">,</span> <span class="n">W_mixed_bulk</span><span class="p">,</span> <span class="n">alat</span><span class="o">=</span><span class="n">alat</span><span class="p">,</span> <span class="n">xyscale</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">plot_axes</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">W_mixed</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> direction ($\AA$)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">W_mixed</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> direction ($\AA$)&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8f0e6f523d8ae5d790bec38a4989057edbbde37064ec25bd1ed9604fc0b94f97.png" src="../_images/8f0e6f523d8ae5d790bec38a4989057edbbde37064ec25bd1ed9604fc0b94f97.png" />
</div>
</div>
<p>It can be seen that the screw displacement component is not local as compared to the case of screw dislocation. This is because in this visualisation edge component of the displacement is not taken into account. It is the full displacement as screw plus edge component that makes a periodic vector leading to perfect structure and thus no displacement far from the dislocation core.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W_mixed_dislo</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">eam_calc</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">PreconLBFGS</span><span class="p">(</span><span class="n">W_mixed_dislo</span><span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:   0  18:11:56    -1378.796211       6.1079
PreconLBFGS:   1  18:11:58    -1379.177181       5.5696
PreconLBFGS:   2  18:11:58    -1379.433631       3.8806
PreconLBFGS:   3  18:11:59    -1379.678480       2.8772
PreconLBFGS:   4  18:12:00    -1379.877549       1.7194
PreconLBFGS:   5  18:12:00    -1380.025465       1.0665
PreconLBFGS:   6  18:12:00    -1380.137886       0.4828
PreconLBFGS:   7  18:12:01    -1380.207597       0.7496
PreconLBFGS:   8  18:12:01    -1380.243102       0.6630
PreconLBFGS:   9  18:12:02    -1380.255614       0.5914
PreconLBFGS:  10  18:12:03    -1380.262569       0.6070
PreconLBFGS:  11  18:12:03    -1380.272479       0.2771
PreconLBFGS:  12  18:12:04    -1380.278208       0.2129
PreconLBFGS:  13  18:12:05    -1380.283037       0.2463
PreconLBFGS:  14  18:12:06    -1380.285827       0.1471
PreconLBFGS:  15  18:12:06    -1380.287208       0.1001
PreconLBFGS:  16  18:12:07    -1380.287801       0.0572
PreconLBFGS:  17  18:12:07    -1380.287999       0.0161
PreconLBFGS:  18  18:12:08    -1380.288042       0.0102
PreconLBFGS:  19  18:12:09    -1380.288059       0.0061
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interactive_view</span><span class="p">(</span><span class="n">W_mixed_dislo</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "dd80ae03bbe5421aa359fa4326d6534f", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">plot_vitek</span><span class="p">(</span><span class="n">W_mixed_dislo</span><span class="p">,</span> <span class="n">W_mixed_bulk</span><span class="p">,</span> <span class="n">alat</span><span class="o">=</span><span class="n">alat</span><span class="p">,</span> <span class="n">xyscale</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">plot_axes</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">W_mixed</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> direction ($\AA$)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">W_mixed</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> direction ($\AA$)&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ad864bb6a531b85eb0d6cfb8ec74870a32863a29088773930517f3930cb173fd.png" src="../_images/ad864bb6a531b85eb0d6cfb8ec74870a32863a29088773930517f3930cb173fd.png" />
</div>
</div>
<p>Spreading of the dislocation core along the glide plane can be seen in the displacement map after relaxation.</p>
</section>
<section id="edge-junction-dislocation">
<h3>&lt;100&gt;{110} edge ‘junction’ dislocation<a class="headerlink" href="#edge-junction-dislocation" title="Permalink to this heading"></a></h3>
<p>So called junction dislocations with burdgers vector along &lt;100&gt; can be formed in the reactions between more abundant dislocations with burgers vector &lt;111&gt; such as:</p>
<div class="math notranslate nohighlight">
\[
    \frac{1}{2}[1\bar{1}1] + \frac{1}{2}[11\bar{1}] = [100]
\]</div>
<p>They share the same glide plane ad 1/2&lt;111&gt; dislocations and can play important role in impurity segregation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matscipy.dislocation</span> <span class="kn">import</span> <span class="n">BCCEdge100110Dislocation</span>

<span class="n">W_edge</span> <span class="o">=</span> <span class="n">BCCEdge100110Dislocation</span><span class="p">(</span><span class="n">alat</span><span class="p">,</span> <span class="n">C11</span><span class="p">,</span> <span class="n">C12</span><span class="p">,</span> <span class="n">C44</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;W&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cell orientation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_edge</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Burgers vector:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_edge</span><span class="o">.</span><span class="n">burgers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cell orientation:
[[ 1  0  0]
 [ 0  1  1]
 [ 0 -1  1]]
Burgers vector:
[3.14339178 0.         0.        ]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W_edge_bulk</span><span class="p">,</span> <span class="n">W_edge_dislo</span> <span class="o">=</span> <span class="n">W_edge</span><span class="o">.</span><span class="n">build_cylinder</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">interactive_view</span><span class="p">(</span><span class="n">W_edge_dislo</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>disloc SCF 0 |d1-d2|_inf = 0.2560104778537572
disloc SCF 1 |d1-d2|_inf = 0.060168332357741605
disloc SCF 2 |d1-d2|_inf = 0.008688118653886967
disloc SCF 3 |d1-d2|_inf = 0.002036828550612449
disloc SCF 4 |d1-d2|_inf = 0.00025500431885919217
disloc SCF 5 |d1-d2|_inf = 8.301996157844549e-05
disloc SCF 6 |d1-d2|_inf = 1.657879984715005e-05
disloc SCF 7 |d1-d2|_inf = 1.7271584200617696e-06
disloc SCF 8 |d1-d2|_inf = 6.753730281694459e-07
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d7fbb8ab564e4cd5868adc766d70fdd3", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W_edge_dislo</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">eam_calc</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">PreconLBFGS</span><span class="p">(</span><span class="n">W_edge_dislo</span><span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:   0  18:20:57    -1730.274578       3.4263
PreconLBFGS:   1  18:20:59    -1730.777063       2.4833
PreconLBFGS:   2  18:20:59    -1731.178752       2.1508
PreconLBFGS:   3  18:21:00    -1731.476037       1.8161
PreconLBFGS:   4  18:21:00    -1731.690456       1.3642
PreconLBFGS:   5  18:21:01    -1731.853182       0.7967
PreconLBFGS:   6  18:21:02    -1731.973529       0.6496
PreconLBFGS:   7  18:21:02    -1732.026735       0.5298
PreconLBFGS:   8  18:21:03    -1732.042318       0.2324
PreconLBFGS:   9  18:21:04    -1732.049330       0.1783
PreconLBFGS:  10  18:21:05    -1732.051240       0.1082
PreconLBFGS:  11  18:21:06    -1732.052185       0.0623
PreconLBFGS:  12  18:21:07    -1732.052429       0.0465
PreconLBFGS:  13  18:21:09    -1732.052507       0.0273
PreconLBFGS:  14  18:21:10    -1732.052541       0.0196
PreconLBFGS:  15  18:21:12    -1732.052557       0.0112
PreconLBFGS:  16  18:21:13    -1732.052567       0.0087
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interactive_view</span><span class="p">(</span><span class="n">W_edge_dislo</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c28fbc37cabf46b7bffb8a6636ed2b1e", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="id1">
<h3>&lt;100&gt;{001} edge dislocation<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h3>
<p>This is the same junction dislocation but lying in a different glide plane.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matscipy.dislocation</span> <span class="kn">import</span> <span class="n">BCCEdge100Dislocation</span>

<span class="n">W_edge</span> <span class="o">=</span> <span class="n">BCCEdge100Dislocation</span><span class="p">(</span><span class="n">alat</span><span class="p">,</span> <span class="n">C11</span><span class="p">,</span> <span class="n">C12</span><span class="p">,</span> <span class="n">C44</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;W&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cell orientation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_edge</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Burgers vector:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W_edge</span><span class="o">.</span><span class="n">burgers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cell orientation:
[[ 1  0  0]
 [ 0  0 -1]
 [ 0  1  0]]
Burgers vector:
[3.14339178 0.         0.        ]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W_edge_bulk</span><span class="p">,</span> <span class="n">W_edge_dislo</span> <span class="o">=</span> <span class="n">W_edge</span><span class="o">.</span><span class="n">build_cylinder</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">interactive_view</span><span class="p">(</span><span class="n">W_edge_dislo</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>disloc SCF 0 |d1-d2|_inf = 0.2972369526680858
disloc SCF 1 |d1-d2|_inf = 0.038938521701512574
disloc SCF 2 |d1-d2|_inf = 0.011189887637262474
disloc SCF 3 |d1-d2|_inf = 0.0014928978841749763
disloc SCF 4 |d1-d2|_inf = 0.0004654204442429144
disloc SCF 5 |d1-d2|_inf = 8.16202896045462e-05
disloc SCF 6 |d1-d2|_inf = 1.3592535523576643e-05
disloc SCF 7 |d1-d2|_inf = 4.370933882835715e-06
disloc SCF 8 |d1-d2|_inf = 5.007789461095036e-07
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "2a990407a4144ae097f576fd3a8fa971", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W_edge_dislo</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">eam_calc</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">PreconLBFGS</span><span class="p">(</span><span class="n">W_edge_dislo</span><span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PreconLBFGS:   0  18:21:44    -1197.049020       4.0122
PreconLBFGS:   1  18:21:46    -1197.620258       2.9055
PreconLBFGS:   2  18:21:46    -1198.067899       2.6049
PreconLBFGS:   3  18:21:47    -1198.399388       2.4441
PreconLBFGS:   4  18:21:47    -1198.586897       1.1265
PreconLBFGS:   5  18:21:47    -1198.671152       1.3040
PreconLBFGS:   6  18:21:48    -1198.697964       0.7715
PreconLBFGS:   7  18:21:49    -1198.716499       0.2101
PreconLBFGS:   8  18:21:50    -1198.718510       0.1449
PreconLBFGS:   9  18:21:50    -1198.719648       0.1189
PreconLBFGS:  10  18:21:51    -1198.720365       0.0850
PreconLBFGS:  11  18:21:52    -1198.720723       0.0767
PreconLBFGS:  12  18:21:53    -1198.720870       0.0402
PreconLBFGS:  13  18:21:54    -1198.720932       0.0269
PreconLBFGS:  14  18:21:55    -1198.720978       0.0333
PreconLBFGS:  15  18:21:56    -1198.721004       0.0175
PreconLBFGS:  16  18:21:57    -1198.721017       0.0121
PreconLBFGS:  17  18:21:58    -1198.721022       0.0046
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interactive_view</span><span class="p">(</span><span class="n">W_edge_dislo</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a0056c8ee94a4568b71887325358d4b4", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
</section>
<section id="face-centered-cubic">
<h2>Face Centered Cubic<a class="headerlink" href="#face-centered-cubic" title="Permalink to this heading"></a></h2>
<p>Work in progress.</p>
</section>
<section id="diamond">
<h2>Diamond<a class="headerlink" href="#diamond" title="Permalink to this heading"></a></h2>
<p>Work in progress.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="plasticity.html" class="btn btn-neutral float-left" title="Plasticity" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="fracture_mechanics.html" class="btn btn-neutral float-right" title="Fracture Mechanics" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2015, James Kermode, Lars Pastewka.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>